{
  "compatibilityLevel": 1550,
  "model": {
    "annotations": [
      {
        "name": "__PBI_TimeIntelligenceEnabled",
        "value": "0"
      },
      {
        "name": "PBIDesktopVersion",
        "value": "2.120.731.0 (23.08)"
      },
      {
        "name": "PBI_QueryOrder",
        "value": "[\"Events\",\"Contacts\",\"Lead Tasks\",\"Key Measures\",\"Last Refresh\",\"Participants\",\"FY Contacts\",\"FY Events\",\"FY Leads\"]"
      },
      {
        "name": "PBI_ProTooling",
        "value": "[\"DevMode\"]"
      }
    ],
    "culture": "en-US",
    "cultures": [
      {
        "name": "en-US",
        "linguisticMetadata": {
          "content": {
            "DynamicImprovement": "HighConfidence",
            "Language": "en-US",
            "Version": "1.0.0"
          },
          "contentType": "json"
        }
      }
    ],
    "dataAccessOptions": {
      "legacyRedirects": true,
      "returnErrorValuesAsNull": true
    },
    "defaultPowerBIDataSourceVersion": "powerBI_V3",
    "relationships": [
      {
        "name": "1174f4a3-cf63-481f-8aef-4dd339f7e94f",
        "fromColumn": "Event ID",
        "fromTable": "Contacts",
        "toColumn": "Event ID",
        "toTable": "Events"
      },
      {
        "name": "1f0cd177-e847-4491-9c39-f132bbee7b21",
        "fromColumn": "Event Date",
        "fromTable": "Events",
        "toColumn": "Date",
        "toTable": "Date"
      },
      {
        "name": "742e1726-8750-4da4-9944-93c4b7a029de",
        "fromColumn": "Contact Dt",
        "fromTable": "Contacts",
        "isActive": false,
        "toColumn": "Date",
        "toTable": "Date"
      },
      {
        "name": "961d0611-e90f-4f3f-8590-59cc375c9ec0",
        "fromColumn": "Sched Dt",
        "fromTable": "Lead Tasks",
        "isActive": false,
        "toColumn": "Date",
        "toTable": "Date"
      },
      {
        "name": "a244627e-59b0-4f99-b972-dc33688c097f",
        "fromColumn": "Event ID",
        "fromTable": "Participants",
        "toColumn": "Event ID",
        "toTable": "Events"
      },
      {
        "name": "f542ff78-5473-427e-b7eb-00a0da8a3d7c",
        "fromColumn": "Event ID",
        "fromTable": "Lead Tasks",
        "toColumn": "Event ID",
        "toTable": "Events"
      },
      {
        "name": "dda09864-3c31-4c31-a19e-95c07f80e8e8",
        "fromColumn": "Event FY",
        "fromTable": "Events",
        "toColumn": "Fiscal Yr",
        "toTable": "FY Events"
      },
      {
        "name": "baeec925-0542-40d5-830b-8d3c49a8f2ed",
        "fromColumn": "Fiscal YearNumber",
        "fromTable": "Date",
        "isActive": false,
        "toColumn": "Fiscal Yr",
        "toTable": "FY Events"
      },
      {
        "name": "4c9cd70a-6c12-43f6-bdae-3f5d1f074ae5",
        "fromColumn": "Contact FY",
        "fromTable": "Contacts",
        "toColumn": "Fiscal Yr",
        "toTable": "FY Contacts"
      },
      {
        "name": "3de63cd3-f533-4dc1-9961-6ed7e0c8d6ab",
        "fromColumn": "Task FY",
        "fromTable": "Lead Tasks",
        "toColumn": "Fiscal Yr",
        "toTable": "FY Leads"
      }
    ],
    "sourceQueryCulture": "en-US",
    "tables": [
      {
        "name": "Date",
        "annotations": [
          {
            "name": "PBI_Id",
            "value": "cdc08361ff824afa953ac8cccd1ff880"
          }
        ],
        "columns": [
          {
            "name": "Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isKey": true,
            "isNameInferred": true,
            "lineageTag": "08bf3a4f-bf2a-441e-826a-0843acd49c15",
            "sourceColumn": "[Date]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "DateKey",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "d73a3ccc-d4fd-4de7-ad78-2f41d93ac3c1",
            "sourceColumn": "[DateKey]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "8b1109be-b04b-4a3b-9ab8-16c583317be7",
            "sortByColumn": "Fiscal YearNumber",
            "sourceColumn": "[Fiscal Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal YearNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "466c1608-aa57-4b63-ad4a-09d7774de223",
            "sourceColumn": "[Fiscal YearNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal QuarterNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "755913af-467f-42fd-b0f0-73f22cba9012",
            "sourceColumn": "[Fiscal QuarterNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "b03e111e-9b48-4fe3-bec4-abda5c85d578",
            "sortByColumn": "Fiscal QuarterNumber",
            "sourceColumn": "[Fiscal Quarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal YearQuarterNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "609add7c-d2a2-48be-ace8-1dff03d23339",
            "sourceColumn": "[Fiscal YearQuarterNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal Quarter Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "6e47a506-72a5-4591-ae3e-b5e6f2fceecf",
            "sortByColumn": "Fiscal YearQuarterNumber",
            "sourceColumn": "[Fiscal Quarter Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal MonthNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "78618e47-8208-4f70-b40e-759feac2c71d",
            "sourceColumn": "[Fiscal MonthNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "7811484d-9a26-4eed-be2a-ef591510542c",
            "sortByColumn": "Fiscal MonthNumber",
            "sourceColumn": "[Fiscal Month]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal YearMonthNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "6aa75064-16ec-4807-97c7-ee4d8edb8632",
            "sourceColumn": "[Fiscal YearMonthNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal Month Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "f82d6825-b09f-46b4-85f8-926747df2c84",
            "sortByColumn": "Fiscal YearMonthNumber",
            "sourceColumn": "[Fiscal Month Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal WeekNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "50bd7bce-0663-40f3-ab31-497fb54437f5",
            "sourceColumn": "[Fiscal WeekNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal Week",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "9dd224df-37b4-4bfc-8e22-82e2cee354f9",
            "sortByColumn": "Fiscal WeekNumber",
            "sourceColumn": "[Fiscal Week]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal YearWeekNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "112c3eea-1630-4a4f-aa89-c385e61a07ea",
            "sourceColumn": "[Fiscal YearWeekNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal Week Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "7a8c42ee-f9bc-44b4-bc5b-39eecfdd4691",
            "sortByColumn": "Fiscal WeekYearOrder",
            "sourceColumn": "[Fiscal Week Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal WeekYearOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "c9990b13-bf7c-4e94-882a-bfa7b2550527",
            "sourceColumn": "[Fiscal WeekYearOrder]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal DayOfYearNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "f11debb1-999b-4c13-b28e-f5c95c07568e",
            "sourceColumn": "[Fiscal DayOfYearNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Day of Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "4006d275-d64e-4b38-ab9a-cecda70b2197",
            "sourceColumn": "[Day of Month]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "WeekDayNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "630ff750-d66b-4749-9123-374e71f8da05",
            "sourceColumn": "[WeekDayNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Week Day",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "4fa2c5e7-9f50-4d86-af6d-2368870b33de",
            "sortByColumn": "WeekDayNumber",
            "sourceColumn": "[Week Day]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal RelativeWeekPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "eb809244-a039-4138-bd9a-ac787c638b0c",
            "sourceColumn": "[Fiscal RelativeWeekPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal RelativeMonthPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "c8339711-545e-43b7-89e2-8835b6083162",
            "sourceColumn": "[Fiscal RelativeMonthPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal RelativeQuarterPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "998c2d4b-6c99-4f30-b188-6229f4b30757",
            "sourceColumn": "[Fiscal RelativeQuarterPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal RelativeYearPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "5d1b647d-5395-4042-84ee-96781e0a0fae",
            "sourceColumn": "[Fiscal RelativeYearPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal StartOfMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "ab693b42-b8c6-4344-9133-0db91257b8b2",
            "sourceColumn": "[Fiscal StartOfMonth]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal EndOfMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "9ae7023f-d64d-469a-b1ad-de9d53d97572",
            "sourceColumn": "[Fiscal EndOfMonth]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal StartOfQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "d9ea70b9-8848-4eea-ae88-76ed5bb8729d",
            "sourceColumn": "[Fiscal StartOfQuarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal EndOfQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "52e365cb-c298-4bf8-aad2-c2d21d6b8957",
            "sourceColumn": "[Fiscal EndOfQuarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar YearNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "11de8adb-db16-415c-acf6-b410e87e11a6",
            "sourceColumn": "[Calendar YearNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "9991dd4c-533b-4773-9b7a-ab0fa8ba98f3",
            "sortByColumn": "Calendar YearNumber",
            "sourceColumn": "[Calendar Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar QuarterNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1a2bbec4-ec1f-4a51-80f3-818a8eb6bc9d",
            "sourceColumn": "[Calendar QuarterNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "5cdebed8-7d47-4e2a-8fb3-cc3bb6f4fe7f",
            "sortByColumn": "Calendar QuarterNumber",
            "sourceColumn": "[Calendar Quarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar YearQuarterNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "d19ed0b3-883a-4265-a0ef-ee01a1111711",
            "sourceColumn": "[Calendar YearQuarterNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar Quarter Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "e6be7f8d-0cea-4dfb-8474-7d3d438232c0",
            "sortByColumn": "Calendar YearQuarterNumber",
            "sourceColumn": "[Calendar Quarter Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar MonthNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "dc675130-fc8c-45ee-a039-4fe3734e0243",
            "sourceColumn": "[Calendar MonthNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "111ff281-7bbb-4002-99f7-1bceb9b241bc",
            "sortByColumn": "Calendar MonthNumber",
            "sourceColumn": "[Calendar Month]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar YearMonthNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "43a7e2db-5e00-4305-ab30-ad0175813930",
            "sourceColumn": "[Calendar YearMonthNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar Month Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "a616577c-8be1-46e4-804b-caff4add1001",
            "sortByColumn": "Calendar YearMonthNumber",
            "sourceColumn": "[Calendar Month Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar WeekNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "569de806-f064-482e-95e3-386ead6aa7c3",
            "sourceColumn": "[Calendar WeekNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar Week",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "e86513d4-f676-495c-88f5-b5ca93442c0e",
            "sortByColumn": "Calendar WeekNumber",
            "sourceColumn": "[Calendar Week]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar YearWeekNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "98d3c6eb-0bb2-4a34-a81d-e4a67ba566ac",
            "sourceColumn": "[Calendar YearWeekNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar Week Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "66bdfce2-1208-45c3-8e7f-afd98113ed27",
            "sortByColumn": "Calendar YearWeekNumber",
            "sourceColumn": "[Calendar Week Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar WeekYearOrder",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "d41b3ecf-159a-4227-87c1-f112efab85f7",
            "sourceColumn": "[Calendar WeekYearOrder]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar DayOfYearNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "77223a20-8cdc-45f1-9ecb-7ef7880a23cb",
            "sourceColumn": "[Calendar DayOfYearNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar RelativeWeekPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "9b331540-e22c-4057-8201-7caa4cc2ec4b",
            "sourceColumn": "[Calendar RelativeWeekPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar RelativeMonthPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "9e816eab-2f34-4655-bdb1-f14b4bc8eed7",
            "sourceColumn": "[Calendar RelativeMonthPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar RelativeQuarterPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "ada6df41-ca1b-4d3d-9b74-901f46c3a043",
            "sourceColumn": "[Calendar RelativeQuarterPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar RelativeYearPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "77b939e5-9a6f-45de-a415-1de95517800d",
            "sourceColumn": "[Calendar RelativeYearPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar StartOfMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "7732cadf-48fb-4108-ae04-474658969920",
            "sourceColumn": "[Calendar StartOfMonth]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar EndOfMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "5bc63357-5ac4-444d-97f5-89e18c701e18",
            "sourceColumn": "[Calendar EndOfMonth]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar StartOfQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "c82789e8-71fb-4702-9ffe-e29db59d9a7a",
            "sourceColumn": "[Calendar StartOfQuarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar EndOfQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "a7efac7c-a80f-47b0-a217-01ed9bc2fa98",
            "sourceColumn": "[Calendar EndOfQuarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW YearNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "ce3c122c-982f-406c-b4dc-81de7b91224f",
            "sourceColumn": "[FW YearNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW StartOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "8c6d0aca-6f8d-4d96-85ed-7f9780dac1da",
            "sourceColumn": "[FW StartOfYear]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW EndOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "34bfa2b2-1e47-422a-82e6-f519f59e5146",
            "sourceColumn": "[FW EndOfYear]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "3f748d07-690b-4a86-8c45-dae4dc2a16f0",
            "sortByColumn": "FW YearNumber",
            "sourceColumn": "[FW Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW QuarterNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "ad57baf9-459a-447d-8923-a065791b0152",
            "sourceColumn": "[FW QuarterNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW Quarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "95361f20-4406-44aa-ba10-53f2808248d5",
            "sortByColumn": "FW QuarterNumber",
            "sourceColumn": "[FW Quarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW YearQuarterNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "b0094c30-730d-463e-a727-2eabfb3506bd",
            "sourceColumn": "[FW YearQuarterNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW Quarter Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "fbde1ac9-0080-4252-9987-c59749d1058e",
            "sortByColumn": "FW YearQuarterNumber",
            "sourceColumn": "[FW Quarter Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW MonthNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1b034951-7269-40f8-9ed4-0230283c3b78",
            "sourceColumn": "[FW MonthNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "01a5e8b3-5e9c-4b6f-a1de-7f734f2eef31",
            "sortByColumn": "FW MonthNumber",
            "sourceColumn": "[FW Month]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW YearMonthNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "c151e20c-a58e-4bc4-90b0-7af61c72f2e8",
            "sourceColumn": "[FW YearMonthNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW Month Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "0959dae6-2929-44de-bd23-617aad476d20",
            "sortByColumn": "FW YearMonthNumber",
            "sourceColumn": "[FW Month Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW WeekNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "8827c035-7f0b-471f-8a7e-65f8397e89e9",
            "sourceColumn": "[FW WeekNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW Week",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "ad36ecb1-292b-454e-88ce-3c86e9c71b56",
            "sortByColumn": "FW WeekNumber",
            "sourceColumn": "[FW Week]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW YearWeekNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "a14a4c12-e203-4185-931d-3c3f4f9f50d4",
            "sourceColumn": "[FW YearWeekNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW Week Year",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "519695d8-6d52-4a49-89c8-75c38ee08bbc",
            "sortByColumn": "FW YearWeekNumber",
            "sourceColumn": "[FW Week Year]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW StartOfWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "87bfc8a1-61fa-419a-9922-4665ab2433ed",
            "sourceColumn": "[FW StartOfWeek]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW EndOfWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "5538027f-a61c-40a9-a175-dd185cfc08c2",
            "sourceColumn": "[FW EndOfWeek]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW RelativeWeekPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "2b856e73-fcea-46cd-ba41-155ce36b4e8d",
            "sourceColumn": "[FW RelativeWeekPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW RelativeMonthPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "687bcc46-cd4f-424a-a178-69e1afdb24cc",
            "sourceColumn": "[FW RelativeMonthPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW RelativeQuarterPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "e08e6835-f808-41df-8903-02b74fbb3c52",
            "sourceColumn": "[FW RelativeQuarterPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW RelativeYearPos",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "ccedc02d-22e7-4b93-bcba-1cc5e60ad859",
            "sourceColumn": "[FW RelativeYearPos]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW StartOfMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "d1110e33-779d-4200-ad2c-9926287e819f",
            "sourceColumn": "[FW StartOfMonth]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW EndOfMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "12b4a879-8a7c-4257-a93b-828f3eb218d7",
            "sourceColumn": "[FW EndOfMonth]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW StartOfQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "8a8591bf-1821-42fc-954b-b8df74454a82",
            "sourceColumn": "[FW StartOfQuarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW EndOfQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "0830b293-36b5-4c58-b1fb-412872db3ad6",
            "sourceColumn": "[FW EndOfQuarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Holiday Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "fc1ac9da-a42f-46d8-8370-1d265a32059d",
            "sourceColumn": "[Holiday Name]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "IsWorkingDay",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "boolean",
            "formatString": "\"TRUE\";\"TRUE\";\"FALSE\"",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "530fec8a-d339-4279-af84-4ed4290011ec",
            "sourceColumn": "[IsWorkingDay]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Day Type",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "40491c10-91d3-41e9-8f65-78f9432194c6",
            "sourceColumn": "[Day Type]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar DatePreviousWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "90c9f845-8a7e-413c-80a7-91f29791dfa1",
            "sourceColumn": "[Calendar DatePreviousWeek]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar DatePreviousMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1e9c7946-b3bb-4559-a57a-cebee21914fd",
            "sourceColumn": "[Calendar DatePreviousMonth]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar DatePreviousQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1194c680-55e7-46dd-9f6f-fe838b8964cc",
            "sourceColumn": "[Calendar DatePreviousQuarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar DatePreviousYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "d302f20a-b8f5-466f-9664-58f4a8c1e133",
            "sourceColumn": "[Calendar DatePreviousYear]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal DatePreviousWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "ac80e134-c1a7-4b31-9428-ba68caa34324",
            "sourceColumn": "[Fiscal DatePreviousWeek]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal DatePreviousMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "011d2b1c-11e1-49c2-a2cb-9c5c95cdf680",
            "sourceColumn": "[Fiscal DatePreviousMonth]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal DatePreviousQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "bb541a09-290b-47e7-a3cf-d39e81764797",
            "sourceColumn": "[Fiscal DatePreviousQuarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal DatePreviousYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "37e22bf4-9527-46f8-b8eb-e7d3eb86df50",
            "sourceColumn": "[Fiscal DatePreviousYear]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW DatePreviousWeek",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "136f6f60-19da-4140-85ba-b5467e5d9e57",
            "sourceColumn": "[FW DatePreviousWeek]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW DatePreviousMonth",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1ec35658-c986-4227-b3c7-49bf98861155",
            "sourceColumn": "[FW DatePreviousMonth]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW DatePreviousQuarter",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "e5430c82-c8bc-418e-afa5-4cf974576fb3",
            "sourceColumn": "[FW DatePreviousQuarter]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW DatePreviousYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "8905ceaf-a952-4bee-b727-aecf1370daca",
            "sourceColumn": "[FW DatePreviousYear]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar StartOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "c181fb9c-c1d9-485e-9623-89f8aa758134",
            "sourceColumn": "[Calendar StartOfYear]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar EndOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "8071ac51-0d38-43d2-9149-eaa3fbb1f6b7",
            "sourceColumn": "[Calendar EndOfYear]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar MonthDays",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "9c965529-909b-463c-b3b0-024b00c6b439",
            "sourceColumn": "[Calendar MonthDays]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar QuarterDays",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "03a45618-bfdd-4dcb-828f-fc0963cfd845",
            "sourceColumn": "[Calendar QuarterDays]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar YearDays",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "680b78e3-6f11-4160-be68-b3c4f4259692",
            "sourceColumn": "[Calendar YearDays]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal StartOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "f2976cae-f3c7-4a6a-88be-d4d0d70a970a",
            "sourceColumn": "[Fiscal StartOfYear]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal EndOfYear",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Short Date",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "a2fbf031-0508-4c0f-86f4-effb171591a7",
            "sourceColumn": "[Fiscal EndOfYear]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal MonthDays",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1907b171-c5d6-4041-97b3-3fbd0007ab45",
            "sourceColumn": "[Fiscal MonthDays]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal QuarterDays",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "8c3f6ded-932c-498b-994b-07fee12cf4ef",
            "sourceColumn": "[Fiscal QuarterDays]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal YearDays",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "1285f125-1d94-402f-91e8-63e2f971a62b",
            "sourceColumn": "[Fiscal YearDays]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW MonthDays",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "17a3d5f4-9400-4de4-b40a-60948b6bfe4d",
            "sourceColumn": "[FW MonthDays]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW QuarterDays",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "49de8ef4-c432-4dcf-814f-fde35cfb2506",
            "sourceColumn": "[FW QuarterDays]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW YearDays",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "3524595e-732e-4968-bbd4-dcff43bf77a2",
            "sourceColumn": "[FW YearDays]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar DayOfMonthNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "380f8656-8f8a-48cf-80c5-1a9517b7681d",
            "sourceColumn": "[Calendar DayOfMonthNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Calendar DayOfQuarterNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "4dd30a61-b84b-4b37-9079-a7df3fe648d1",
            "sourceColumn": "[Calendar DayOfQuarterNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal DayOfMonthNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "d104c2f4-4aed-4672-85e0-5741965f7b25",
            "sourceColumn": "[Fiscal DayOfMonthNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Fiscal DayOfQuarterNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "17c3fec5-dc93-4481-a76a-30cf6d323f79",
            "sourceColumn": "[Fiscal DayOfQuarterNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW DayOfYearNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "0d3991e1-7e6f-4239-a333-b45a04da0dab",
            "sourceColumn": "[FW DayOfYearNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW DayOfMonthNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "7d9a876f-7944-4c48-be61-c0d660cf0a61",
            "sourceColumn": "[FW DayOfMonthNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW DayOfQuarterNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "326de38a-532e-4e7c-9ab0-cc639421280f",
            "sourceColumn": "[FW DayOfQuarterNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "Sequential365DayNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "0aba48e0-c9f0-47fd-adfc-c2cab7a584b7",
            "sourceColumn": "[Sequential365DayNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW PeriodNumber",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "User"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "66bd328d-18fd-497c-9e6f-c8af19758483",
            "sourceColumn": "[FW PeriodNumber]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          },
          {
            "name": "FW Period",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isDataTypeInferred": true,
            "isNameInferred": true,
            "lineageTag": "25b3deb7-c151-4bd9-b2c5-a5c8af08a179",
            "sortByColumn": "FW PeriodNumber",
            "sourceColumn": "[FW Period]",
            "summarizeBy": "none",
            "type": "calculatedTableColumn"
          }
        ],
        "dataCategory": "Time",
        "hierarchies": [
          {
            "name": "Calendar Months",
            "levels": [
              {
                "name": "Year",
                "column": "Calendar Year",
                "lineageTag": "f644dd41-08e7-4570-8988-0a394562c8d2",
                "ordinal": 0
              },
              {
                "name": "Month",
                "column": "Calendar Month Year",
                "lineageTag": "7f672073-e180-4004-b933-f1459b10a48e",
                "ordinal": 1
              }
            ],
            "lineageTag": "9f007104-06ce-4ea2-82ab-d3e62bd383be"
          },
          {
            "name": "Calendar Weeks",
            "levels": [
              {
                "name": "Year",
                "column": "Calendar Year",
                "lineageTag": "d4c6d432-01fa-4b9c-9ffb-c0834dcbc7f4",
                "ordinal": 0
              },
              {
                "name": "Week",
                "column": "Calendar Week Year",
                "lineageTag": "5abb9744-49c5-43dc-b7d7-9aa6e14c03c9",
                "ordinal": 1
              }
            ],
            "lineageTag": "8ffe831c-2eb6-4369-bcca-6e07a68dba09"
          },
          {
            "name": "Calendar Quarters",
            "levels": [
              {
                "name": "Year",
                "column": "Calendar Year",
                "lineageTag": "cbe77fea-5151-4f3f-9407-9e24ff23b392",
                "ordinal": 0
              },
              {
                "name": "Quarter",
                "column": "Calendar Quarter Year",
                "lineageTag": "c8496f3a-a60e-40fd-9d70-0e06363e62bd",
                "ordinal": 1
              },
              {
                "name": "Month",
                "column": "Calendar Month Year",
                "lineageTag": "33ea910d-b624-4e33-873b-b60f71d42844",
                "ordinal": 2
              }
            ],
            "lineageTag": "21397cbb-a4db-45bd-a92f-e33d827971d1"
          },
          {
            "name": "Fiscal Weeks",
            "levels": [
              {
                "name": "Year",
                "column": "Fiscal Year",
                "lineageTag": "416629d1-e550-47ff-8e0c-668ff7c35f5a",
                "ordinal": 0
              },
              {
                "name": "Week",
                "column": "Fiscal Week Year",
                "lineageTag": "7abea960-6aa2-48e8-9ac3-3e9533f302f1",
                "ordinal": 1
              }
            ],
            "lineageTag": "da8d55dc-79eb-4129-a131-2e831ff2bee8"
          },
          {
            "name": "Fiscal Quarters",
            "levels": [
              {
                "name": "Year",
                "column": "Fiscal Year",
                "lineageTag": "2a67beac-4b91-44a8-a64f-676c8728c39d",
                "ordinal": 0
              },
              {
                "name": "Quarter",
                "column": "Fiscal Quarter",
                "lineageTag": "223e8196-5d28-47bf-a7b8-a338dcd9a20e",
                "ordinal": 1
              },
              {
                "name": "Month",
                "column": "Fiscal Month",
                "lineageTag": "e03abfea-1340-4b8f-8360-cfcfe06a8b51",
                "ordinal": 2
              }
            ],
            "lineageTag": "4f5b7599-5edb-4b07-a95d-71a49f282125"
          },
          {
            "name": "Fiscal Months",
            "levels": [
              {
                "name": "Year",
                "column": "Fiscal Year",
                "lineageTag": "8ec39116-1380-4993-aa33-743c21df8fc2",
                "ordinal": 0
              },
              {
                "name": "Month",
                "column": "Fiscal Month",
                "lineageTag": "59605334-6eae-488b-a263-e55aaa8b70d4",
                "ordinal": 1
              }
            ],
            "lineageTag": "1cfffaa4-40f0-44f4-a26e-0aefdbac8bc4"
          },
          {
            "name": "FW Months",
            "levels": [
              {
                "name": "Year",
                "column": "FW Year",
                "lineageTag": "56b51848-ee4e-406e-9b83-1d2c2da9ae35",
                "ordinal": 0
              },
              {
                "name": "Month",
                "column": "FW Month",
                "lineageTag": "4d3636ac-8bd7-46f1-802a-4083697ef652",
                "ordinal": 1
              }
            ],
            "lineageTag": "b0f8383c-d7fc-4d38-bf6e-2d5d773b8e7e"
          },
          {
            "name": "FW Quarters",
            "levels": [
              {
                "name": "Year",
                "column": "FW Year",
                "lineageTag": "302b673e-a81b-43d4-97f1-2986904de015",
                "ordinal": 0
              },
              {
                "name": "Quarter",
                "column": "FW Quarter",
                "lineageTag": "3a7182fb-6c80-4b8a-8853-bff50eeb5fa2",
                "ordinal": 1
              },
              {
                "name": "Month",
                "column": "FW Month",
                "lineageTag": "dca7ea12-85a4-4ea7-b9bd-d1a0c8eee9cd",
                "ordinal": 2
              }
            ],
            "lineageTag": "957c0e51-520e-4828-901f-d3f30d3e2007"
          },
          {
            "name": "FW Weeks",
            "levels": [
              {
                "name": "Year",
                "column": "FW Year",
                "lineageTag": "b061462e-805f-414f-9531-4b44f7be5135",
                "ordinal": 0
              },
              {
                "name": "Week",
                "column": "FW EndOfWeek",
                "lineageTag": "51373020-3878-4819-845f-dc9f65a68ec4",
                "ordinal": 1
              }
            ],
            "lineageTag": "e9f261bb-8b82-4f9d-b607-142da0f59ee1"
          },
          {
            "name": "FW Periods",
            "levels": [
              {
                "name": "Year",
                "column": "FW Year",
                "lineageTag": "f16b3472-64d7-4efb-8f5b-0924b1f5bbd8",
                "ordinal": 0
              },
              {
                "name": "Period",
                "column": "FW Period",
                "lineageTag": "ea6d0493-ef60-48c3-a1c2-bab81ca0b8d4",
                "ordinal": 1
              },
              {
                "name": "Week",
                "column": "FW EndOfWeek",
                "lineageTag": "279dc151-85f9-402a-b8ff-bbbeb367dce7",
                "ordinal": 2
              }
            ],
            "lineageTag": "83beaa58-3bc8-4e75-82e8-c4673db27c14"
          }
        ],
        "lineageTag": "cb0302d8-14a9-4b08-8f59-8b4ba0523c6e",
        "measures": [
          {
            "name": "Period",
            "expression": [
              "",
              "VAR FirstDay = MIN ( 'Date'[Date] )",
              "VAR LastDay = MAX ( 'Date'[Date] )",
              "RETURN ",
              "    FORMAT ( FirstDay, \"dd MMM yy\" ) & \" - \" & FORMAT ( LastDay, \"dd MMM yy\" )  "
            ],
            "lineageTag": "3fd0f1a6-7716-4efb-8458-ce41933a281c"
          }
        ],
        "partitions": [
          {
            "name": "Date-e5e43593-f014-4047-9082-dc37b82a4652",
            "mode": "import",
            "source": {
              "expression": [
                "",
                "------------------------------------------------------------",
                "--",
                "-- Configuration",
                "--",
                "------------------------------------------------------------",
                "VAR TodayReference =",
                "    TODAY () -- Change this if you need to use another date as a reference \"current\" day",
                "VAR FirstYear = 2019",
                "VAR LastYear = ",
                "    YEAR ( TodayReference )",
                "VAR FiscalCalendarFirstMonth = 7 -- For Fiscal 52-53 weeks (start depends on rules) and Gregorian (starts on the first of the month) ",
                "VAR FirstDayOfWeek = 0 -- Use: 0 - Sunday, 1 - Monday, 2 - Tuesday, ... 5 - Friday, 6 - Saturday",
                "VAR TypeStartFiscalYear = 1 -- Fiscal year as Calendar Year of : 0 - First day of fiscal year, 1 - Last day of fiscal year",
                "VAR IsoCountryHolidays = \"US\" -- Use only supported ISO countries or \"\" for no holidays",
                "VAR WeeklyType = \"Last\" -- Use: \"Nearest\" or \"Last\" ",
                "VAR QuarterWeekType = \"445\" -- Supports only \"445\", \"454\", and \"544\"",
                "VAR CalendarRange = \"Calendar\" -- Supports \"Calendar\", \"FiscalGregorian\", \"FiscalWeekly\"",
                "-- Last:    for last weekday of the month at fiscal year end",
                "-- Nearest: for last weekday nearest the end of month ",
                "-- Reference for Last/Nearest definition: https://en.wikipedia.org/wiki/4%E2%80%934%E2%80%935_calendar)",
                "--",
                "-- For ISO calendar use ",
                "--   FiscalCalendarFirstMonth = 1 (ISO always starts in January)",
                "--   FirstDayOfWeek = 1           (ISO always starts on Monday)",
                "--   WeeklyType = \"Nearest\"       (ISO use the nearest week type algorithm)",
                "-- For US with last Saturday of the month at fiscal year end",
                "--   FirstDayOfWeek = 0           (US weeks start on Sunday)",
                "--   WeeklyType = \"Last\"",
                "-- For US with last Saturday nearest the end of month",
                "--   FirstDayOfWeek = 0           (US weeks start on Sunday)",
                "--   WeeklyType = \"Nearest\"",
                "--",
                "------------------------------",
                "VAR CalendarGregorianPrefix = \"\" -- Prefix used in columns of standard Gregorian calendar",
                "VAR FiscalGregorianPrefix = \"FY\" -- Prefix used in columns of fiscal Gregorian calendar",
                "VAR FiscalWeeklyPrefix = \"FW \" -- Prefix used in columns of fiscal weekly calendar",
                "VAR WorkingDayType = \"Working day\" -- Description for working days",
                "VAR NonWorkingDayType = \"Non-working day\" -- Description for non-working days",
                "------------------------------",
                "VAR WeeklyCalendarType = \"Weekly\" -- Supports \"Weekly\", \"Custom\"",
                "-- Set the working days - 0 = Sunday, 1 = Monday, ... 6 = Saturday",
                "VAR WorkingDays =",
                "    DATATABLE ( \"WorkingDayNumber\", INTEGER, { { 1 }, { 2 }, { 3 }, { 4 }, { 5 } } ) --",
                "",
                "-- Use CustomFiscalPeriods in case you need arbitrary definition of weekly fiscal years ",
                "-- Set \"UseCustomFiscalPeriods\" to TRUE in order to use CustomFiscalPeriods ",
                "VAR UseCustomFiscalPeriods = FALSE",
                "-- Set \"IgnoreWeeklyFiscalPeriods\" to TRUE in order to ignore the WeeklyFiscalPeriods",
                "-- You should set IgnoreWeeklyFiscalPeriods to TRUE only when UseCustomFiscalPeriods is TRUE, too",
                "VAR IgnoreWeeklyFiscalPeriods = FALSE",
                "-- Include here your own definition of custom fiscal periods",
                "VAR CustomFiscalPeriods =",
                "    FILTER ( ",
                "        DATATABLE (",
                "            \"Fiscal YearNumber\", INTEGER,",
                "            \"FirstDayOfYear\", DATETIME,",
                "            \"LastDayOfYear\", DATETIME,",
                "            {",
                "    \t\t\t-- IMPORTANT!!! The first day of each year must be a weekday corresponding to the definition of FirstDayOfWeek",
                "    \t\t\t--              If you want to use this table, remember to set the UseCustomFiscalPeriods variable to TRUE",
                "    \t\t\t--              If the IgnoreWeeklyFiscalPeriods is TRUE, there are no warnings in case the FirstDayOfWeek ",
                "    \t\t\t--              does not match the first day of the year ",
                "                { 2016, \"2015-06-28\", \"2016-07-02\" },",
                "                { 2017, \"2016-07-03\", \"2017-07-01\" },",
                "                { 2018, \"2017-07-02\", \"2018-06-30\" },",
                "                { 2019, \"2018-07-01\", \"2019-06-29\" }",
                "            }",
                "        ),",
                "        UseCustomFiscalPeriods",
                "    )",
                "",
                "------------------------------------------------------------",
                "--  ",
                "-- End of General Configuration",
                "--",
                "------------------------------------------------------------",
                "--  ",
                "-- The following variables define specific parameters ",
                "-- for calendars - you should modify them only to ",
                "-- change configuration of specific countries, translate ",
                "-- names of holidays, or to add configuration for other ",
                "-- countries",
                "--",
                "------------------------------------------------------------",
                "VAR InLieuOf_prefix = \"(in lieu of \" -- prefix of substitute holidays",
                "VAR InLieuOf_suffix = \")\" -- prefix of substitute holidays",
                "VAR HolidayParameters =",
                "    DATATABLE (",
                "        \"ISO Country\", STRING,",
                "        -- ISO country code (to enable filter based on country)",
                "        \"MonthNumber\", INTEGER,",
                "        -- Number of month - use 99 for relative dates using Easter as a reference",
                "        \"DayNumber\", INTEGER,",
                "        -- Absolute day (ignore WeekDayNumber, otherwise use 0)",
                "        \"WeekDayNumber\", INTEGER,",
                "        -- 0 = Sunday, 1 = Monday, ... , 7 = Saturday",
                "        \"OffsetWeek\", INTEGER,",
                "        -- 1 = first, 2 = second, ... -1 = last, -2 = second-last, ...",
                "        \"OffsetDays\", INTEGER,",
                "        -- days to add after offsetWeek and WeekDayNumber have been applied",
                "        \"HolidayName\", STRING,",
                "        -- Holiday name ",
                "        \"SubstituteHoliday\", INTEGER,",
                "        -- 0 = no substituteHoliday, 1 = substitute holiday with next working day, 2 = substitute holiday with next working day ",
                "        -- (use 2 before 1 only, e.g. Christmas = 2, Boxing Day = 1)",
                "        \"ConflictPriority\", INTEGER,",
                "        -- Priority in case of two or more holidays in the same date - lower number --> higher priority",
                "        -- For example: marking Easter relative days with 150 and other holidays with 100 means that other holidays take ",
                "        --              precedence over Easter-related days; use 50 for Easter related holidays to invert such a priority",
                "        {",
                "            --",
                "            -- US = United States",
                "            { \"US\", 1, 1, 0, 0, 0, \"New Year's Day\", 0, 100 },",
                "            { \"US\", 1, 0, 1, 3, 0, \"Martin Luther King, Jr.\", 0, 100 },",
                "            { \"US\", 2, 0, 1, 3, 0, \"Presidents' Day\", 0, 100 },",
                "            // aka Washington's Birthday",
                "            { \"US\", 5, 0, 1, -1, 0, \"Memorial Day\", 0, 100 },",
                "            { \"US\", 7, 4, 0, 0, 0, \"Independence Day\", 0, 100 },",
                "            { \"US\", 9, 0, 1, 1, 0, \"Labor Day\", 0, 100 },",
                "            { \"US\", 10, 0, 1, 2, 0, \"Columbus Day\", 0, 100 },",
                "            { \"US\", 11, 11, 0, 0, 0, \"Veterans Day\", 0, 100 },",
                "            { \"US\", 11, 0, 4, 4, 0, \"Thanksgiving Day\", 0, 100 },",
                "            { \"US\", 11, 0, 4, 4, 1, \"Black Friday\", 0, 100 },",
                "            { \"US\", 12, 25, 0, 0, 0, \"Christmas Day\", 0, 100 },",
                "            --",
                "            -- CA = Canada (include only nationwide and Thanksgiving)",
                "            { \"CA\", 1, 1, 0, 0, 0, \"New Year's Day\", 0, 100 },",
                "            { \"CA\", 99, -2, 0, 0, 0, \"Good Friday\", 0, 50 },",
                "            { \"CA\", 7, 1, 0, 0, 0, \"Canada Day\", 0, 100 },",
                "            { \"CA\", 9, 0, 1, 1, 0, \"Labour Day\", 0, 100 },",
                "            { \"CA\", 10, 0, 1, 2, 0, \"Thanksgiving\", 0, 100 },",
                "            { \"CA\", 12, 25, 0, 0, 0, \"Christmas Day\", 0, 100 },",
                "            --",
                "            -- UK = England (different configuration in Scotland and Northern Ireland)",
                "            { \"UK\", 1, 1, 0, 0, 0, \"New Year's Day\", 1, 100 },",
                "            { \"UK\", 99, -2, 0, 0, 0, \"Good Friday\", 0, 50 },",
                "            { \"UK\", 99, 1, 0, 0, 0, \"Easter Monday\", 0, 50 },",
                "            { \"UK\", 5, 0, 1, 1, 0, \"May Day Bank Holiday\", 0, 100 },",
                "            { \"UK\", 5, 0, 1, -1, 0, \"Spring Bank Holiday\", 0, 100 },",
                "            { \"UK\", 8, 0, 1, -1, 0, \"Late Summer Bank Holiday\", 0, 100 },",
                "            { \"UK\", 12, 25, 0, 0, 0, \"Christmas Day\", 2, 100 },",
                "            { \"UK\", 12, 26, 0, 0, 0, \"Boxing Day\", 1, 100 },",
                "            --",
                "            -- AU = Australia",
                "            { \"AU\", 1, 1, 0, 0, 0, \"New Year's Day\", 1, 100 },",
                "            { \"AU\", 1, 26, 0, 0, 0, \"Australia Day\", 1, 100},",
                "            { \"AU\", 99, -2, 0, 0, 0, \"Good Friday\", 0, 50 },",
                "            { \"AU\", 99, 1, 0, 0, 0, \"Easter Monday\", 0, 50 },",
                "            { \"AU\", 4, 25, 0, 0, 0, \"Anzac Day\", 1, 100 },",
                "            { \"AU\", 12, 25, 0, 0, 0, \"Christmas Day\", 2, 100 },",
                "            { \"AU\", 12, 26, 0, 0, 0, \"Boxing Day\", 1, 100 },",
                "            --",
                "            -- DE = Germany",
                "            { \"DE\", 1, 1, 0, 0, 0, \"New Year's Day\", 0, 100 },",
                "            { \"DE\", 99, -2, 0, 0, 0, \"Good Friday\", 0, 50 },",
                "            { \"DE\", 99, 1, 0, 0, 0, \"Easter Monday\", 0, 50 },",
                "            { \"DE\", 5, 1, 0, 0, 0, \"Labour Day\", 0, 100 },",
                "            { \"DE\", 99, 39, 0, 0, 0, \"Ascension Day\", 0, 50 },",
                "            { \"DE\", 99, 50, 0, 0, 0, \"Whit Monday\", 0, 50 },",
                "            { \"DE\", 10, 3, 0, 0, 0, \"German Unity Day\", 0, 100 },",
                "            { \"DE\", 12, 25, 0, 0, 0, \"Christmas Day\", 0, 100 },",
                "            { \"DE\", 12, 26, 0, 0, 0, \"St. Stephen's Day\", 0, 100 },",
                "            --",
                "            -- FR = France",
                "            { \"FR\", 1, 1, 0, 0, 0, \"New Year's Day\", 0, 100 },",
                "            { \"FR\", 99, 1, 0, 0, 0, \"Easter Monday\", 0, 50 },",
                "            { \"FR\", 5, 1, 0, 0, 0, \"Labour Day\", 0, 100 },",
                "            { \"FR\", 5, 8, 0, 0, 0, \"Victor in Europe Day\", 0, 100 },",
                "            { \"FR\", 99, 39, 0, 0, 0, \"Ascension Day\", 0, 50 },",
                "            { \"FR\", 99, 50, 0, 0, 0, \"Whit Monday\", 0, 50 },",
                "            { \"FR\", 7, 14, 0, 0, 0, \"Bastille Day\", 0, 100 },",
                "            { \"FR\", 8, 15, 0, 0, 0, \"Assumption Day\", 0, 100 },",
                "            { \"FR\", 11, 1, 0, 0, 0, \"All Saints' Day\", 0, 100 },",
                "            { \"FR\", 11, 11, 0, 0, 0, \"Armistice Day\", 0, 100 },",
                "            { \"FR\", 12, 25, 0, 0, 0, \"Christmas Day\", 0, 100 },",
                "            --",
                "            -- IT = Italy",
                "            { \"IT\", 1, 1, 0, 0, 0, \"New Year's Day\", 0, 100 },",
                "            { \"IT\", 1, 6, 0, 0, 0, \"Epiphany\", 0, 100 },",
                "            { \"IT\", 99, 1, 0, 0, 0, \"Easter Monday\", 0, 100 },",
                "            { \"IT\", 4, 25, 0, 0, 0, \"Liberation Day\", 0, 100 },",
                "            { \"IT\", 5, 1, 0, 0, 0, \"Labour Day\", 0, 100 },",
                "            { \"IT\", 6, 2, 0, 0, 0, \"Republic Day\", 0, 100 },",
                "            { \"IT\", 8, 15, 0, 0, 0, \"Assumption Day\", 0, 100 },",
                "            { \"IT\", 11, 1, 0, 0, 0, \"All Saints' Day\", 0, 100 },",
                "            { \"IT\", 12, 8, 0, 0, 0, \"Immaculate Conception\", 0, 100 },",
                "            { \"IT\", 12, 25, 0, 0, 0, \"Christmas Day\", 0, 100 },",
                "            { \"IT\", 12, 26, 0, 0, 0, \"St. Stephen's Day\", 0, 100 },",
                "            --",
                "            -- ES = Spain",
                "            { \"ES\", 1, 1, 0, 0,0,  \"New Year's Day\", 0, 100 },",
                "            { \"ES\", 1, 6, 0, 0, 0, \"Epiphany\", 0, 100 },",
                "            { \"ES\", 99, -3, 0, 0, 0, \"Maundy Thursday\", 0, 50 },",
                "            // Except Catalonia",
                "            { \"ES\", 99, -2, 0, 0, 0, \"Good Friday\", 0, 50 },",
                "            { \"ES\", 99, 1, 0, 0, 0, \"Easter Monday\", 0, 50 },",
                "            // Belearic Islands, Basque Country, Catalonia, La Rioja, Navarra and Valenciana only",
                "            { \"ES\", 5, 1, 0, 0, 0, \"Labour Day\", 0, 100 },",
                "            { \"ES\", 8, 15, 0, 0, 0, \"Assumption Day\", 0, 100 },",
                "            { \"ES\", 10, 12, 0, 0, 0, \"Fiesta Navional de Espaa\", 0, 100 },",
                "            { \"ES\", 11, 1, 0, 0, 0, \"All Saints' Day\", 0, 100 },",
                "            { \"ES\", 12, 6, 0, 0, 0, \"Constitution Day\", 0, 100 },",
                "            { \"ES\", 12, 8, 0, 0, 0, \"Immaculate Conception\", 0, 100 },",
                "            { \"ES\", 12, 25, 0, 0, 0, \"Christmas Day\", 0, 100 },",
                "            --",
                "            -- NL = The Netherlands",
                "            { \"NL\", 1, 1, 0, 0, 0, \"New Year's Day\", 0, 100 },",
                "            { \"NL\", 99, 1, 0, 0, 0, \"Easter Monday\", 0, 50 },",
                "            { \"NL\", 99, 39, 0, 0, 0, \"Ascension Day\", 0, 50 },",
                "            { \"NL\", 99, 50, 0, 0, 0, \"Whit Monday\", 0, 50 },",
                "            { \"NL\", 4, 27, 0, 0, 0, \"King's Day\", 0, 100 },",
                "            // King's day shifted to Saturday if on a Sunday - not handled in this calendar",
                "            { \"NL\", 5, 5, 0, 0, 0, \"Liberation Day\", 0, 100 },",
                "            { \"NL\", 12, 25, 0, 0, 0, \"Christmas Day\", 0, 100 },",
                "            { \"NL\", 12, 26, 0, 0, 0, \"St. Stephen's Day\", 0, 100 },",
                "            --",
                "            -- SE = Sweden",
                "            { \"SE\", 1, 1, 0, 0, 0, \"New Year's Day\", 0, 100 },",
                "            { \"SE\", 1, 6, 0, 0, 0, \"Epiphany\", 0, 100 },",
                "            { \"SE\", 99, -2, 0, 0, 0, \"Good Friday\", 0, 50 },",
                "            { \"SE\", 99, 1, 0, 0, 0, \"Easter Monday\", 0, 50 },",
                "            { \"SE\", 99, 39, 0, 0, 0, \"Ascension Day\", 0, 50 },",
                "            { \"SE\", 5, 1, 0, 0, 0, \"Labour Day\", 0, 100 },",
                "            { \"SE\", 6, 6, 0, 0, 0, \"National Day\", 0, 100 },",
                "            { \"SE\", 12, 25, 0, 0, 0, \"Christmas Day\", 0, 100 },",
                "            { \"SE\", 12, 26, 0, 0, 0, \"Boxing Day\", 0, 100 },",
                "            -- De facto Holidays in Sweden - not official public holidays",
                "            { \"SE\", 12, 24, 0, 0, 0, \"Christmas Eve\", 0, 50 },",
                "            { \"SE\", 12, 31, 0, 0, 0, \"New Year's Eve\", 0, 50 },",
                "            { \"SE\", 98, -1, 0, 0, 0, \"Midsummer Eve\", 0, 50 },",
                "            -- Midsummer Day is a Saturday",
                "            -- { \"SE\", 98, 0, 0, 0, \"Midsummer Day\", 0, 50 },",
                "            ------------------------------------------------------------            ",
                "            --",
                "            -- BE = Belgium",
                "            { \"BE\", 1, 1, 0, 0, 0, \"New Year's Day\", 0, 100 },",
                "            { \"BE\", 99, 1, 0, 0, 0, \"Easter Monday\", 0, 50 },",
                "            { \"BE\", 99, 39, 0, 0, 0, \"Ascension Day\", 0, 50 },",
                "            { \"BE\", 99, 50, 0, 0, 0, \"Whit Monday\", 0, 50 },",
                "            { \"BE\", 5, 1, 0, 0, 0, \"Labour Day\", 0, 100 },",
                "            { \"BE\", 7, 21, 0, 0, 0, \"Belgian National DayDay\", 0, 100 },",
                "            { \"BE\", 8, 15, 0, 0, 0, \"Assumption Day\", 0, 100 },",
                "            { \"BE\", 11, 1, 0, 0, 0, \"All Saints' Day\", 0, 100 },",
                "            { \"BE\", 11, 11, 0, 0, 0, \"Armistice Day\", 0, 100 },",
                "            { \"BE\", 12, 25, 0, 0,0, \"Christmas Day\", 0, 100 },",
                "\t\t\t--",
                "            -- PT = Portugal",
                "            { \"PT\", 1, 1, 0, 0, 0, \"New Year's Day\", 0, 100 },",
                "            { \"PT\", 99, -2, 0, 0, 0, \"Good Friday\", 0, 50 },",
                "            { \"PT\", 99, 60, 0, 0, 0, \"Corpus Christi\", 0, 50 },",
                "            { \"PT\", 4, 25, 0, 0, 0, \"Freedom Day\", 0, 100 },",
                "            { \"PT\", 5, 1, 0, 0, 0, \"Labour Day\", 0, 100 },",
                "            { \"PT\", 6, 10, 0, 0, 0, \"Portugal Day\", 0, 100 },",
                "            { \"PT\", 8, 15, 0, 0, 0, \"Assumption Day\", 0, 100 },",
                "            { \"PT\", 10, 5, 0, 0, 0, \"Republic Day\", 0, 100 },",
                "            { \"PT\", 11, 1, 0, 0, 0, \"All Saints' Day\", 0, 100 },",
                "            { \"PT\", 12, 1, 0, 0, 0, \"Restoration of Independence\", 0, 100 },",
                "            { \"PT\", 12, 8, 0, 0, 0, \"Immaculate Conception\", 0, 100 },",
                "            { \"PT\", 12, 25, 0, 0, 0, \"Christmas Day\", 0, 100 }",
                "",
                "        }",
                "    )",
                "VAR HolidayDates_ConfigGeneration =",
                "    FILTER (",
                "        HolidayParameters,",
                "        IF (",
                "            CONTAINS ( HolidayParameters, [ISO Country], IsoCountryHolidays )",
                "                || IsoCountryHolidays = \"\",",
                "            [ISO Country] = IsoCountryHolidays,",
                "            ERROR ( \"IsoCountryHolidays set to an unsupported contry code\" )",
                "        )",
                "    )",
                "VAR HolidayDates_GeneratedRawWithDuplicates =",
                "    GENERATE (",
                "        GENERATE (",
                "            GENERATESERIES ( FirstYear - 1, LastYear + 1, 1 ),",
                "            HolidayDates_ConfigGeneration",
                "        ),",
                "        VAR HolidayYear = [Value]",
                "        VAR EasterDate =",
                "            -- Code adapted from original VB version from https://www.assa.org.au/edm ",
                "            VAR EasterYear = HolidayYear",
                "            VAR FirstDig =",
                "                INT ( EasterYear / 100 )",
                "            VAR Remain19 =",
                "                MOD ( EasterYear, 19 ) //",
                "            -- Calculate PFM date",
                "            VAR temp1 =",
                "                MOD (",
                "                    INT ( ( FirstDig - 15 ) / 2 )",
                "                        + 202",
                "                        - 11 * Remain19",
                "                        + SWITCH (",
                "                            TRUE,",
                "                            FirstDig IN { 21, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35, 38 }, -1,",
                "                            FirstDig IN { 33, 36, 37, 39, 40 }, -2,",
                "                            0",
                "                        ),",
                "                    30",
                "                )",
                "            VAR tA =",
                "                temp1 + 21",
                "                    + IF ( temp1 = 29 || ( temp1 = 28 && Remain19 > 10 ), -1 ) // ",
                "            -- Find the next Sunday",
                "            VAR tB =",
                "                MOD ( tA - 19, 7 )",
                "            VAR tCpre =",
                "                MOD ( 40 - FirstDig, 4 )",
                "            VAR tC =",
                "                tCpre",
                "                    + IF ( tCpre = 3, 1 )",
                "                    + IF ( tCpre > 1, 1 )",
                "            VAR temp2 =",
                "                MOD ( EasterYear, 100 )",
                "            VAR tD =",
                "                MOD ( temp2 + INT ( temp2 / 4 ), 7 )",
                "            VAR tE =",
                "                MOD ( 20 - tB - tC - tD, 7 )",
                "                    + 1",
                "            VAR d = tA + tE //",
                "            -- Return the date",
                "            VAR EasterDay =",
                "                IF ( d > 31, d - 31, d )",
                "            VAR EasterMonth =",
                "                IF ( d > 31, 4, 3 )",
                "            RETURN",
                "                DATE ( EasterYear, EasterMonth, EasterDay ) //",
                "        -- End of code adapted from original VB version from https://www.assa.org.au/edm ",
                "        VAR SwedishMidSummer =",
                "            -- Compute the Midsummer day in Swedish - it is the Saturday between 20 and 26 June",
                "            -- This calculation is valid only for years after 1953 ",
                "            -- https://sv.wikipedia.org/wiki/Midsommar_i_Sverige",
                "            VAR __June20 = ",
                "                DATE ( HolidayYear, 6, 20 )",
                "            RETURN",
                "                DATE ( HolidayYear, 6, 20 + (7 - WEEKDAY ( __June20, 1 ) ) )",
                "            -- End of SwedishMidSummer calculation",
                "        VAR HolidayDate =",
                "            SWITCH (",
                "                TRUE,",
                "                [DayNumber] <> 0",
                "                    && [WeekDayNumber] <> 0, ERROR ( \"Wrong configuration in HolidayParameters\" ),",
                "                [DayNumber] <> 0",
                "                    && [MonthNumber] <= 12, DATE ( HolidayYear, [MonthNumber], [DayNumber] ),",
                "                [MonthNumber] = 99, -- Easter offset",
                "                    EasterDate + [DayNumber],",
                "                [MonthNumber] = 98, -- Swedish Midsummer Day",
                "                    SwedishMidSummer + [DayNumber],",
                "                [WeekDayNumber] <> 0,",
                "                    VAR ReferenceDate =",
                "                        DATE ( HolidayYear, 1",
                "                            + MOD ( [MonthNumber] - 1 + IF ( [OffsetWeek] < 0, 1 ), 12 ), 1 )",
                "                            - IF ( [OffsetWeek] < 0, 1 )",
                "                    VAR ReferenceWeekDayNumber =",
                "                        WEEKDAY ( ReferenceDate, 1 ) - 1",
                "                    VAR Offset =",
                "                        [WeekDayNumber] - ReferenceWeekDayNumber",
                "                            + 7 * [OffsetWeek]",
                "                            + IF (",
                "                                [OffsetWeek] > 0,",
                "                                IF ( [WeekDayNumber] >= ReferenceWeekDayNumber, - 7 ),",
                "                                IF ( ReferenceWeekDayNumber >= [WeekDayNumber], 7 )",
                "                            )",
                "                RETURN",
                "                    ReferenceDate + Offset + [OffsetDays],",
                "                ERROR ( \"Wrong configuration in HolidayParameters\" )",
                "            )",
                "        VAR HolidayDay =",
                "            WEEKDAY ( HolidayDate, 1 ) - 1",
                "        VAR SubstituteHolidayOffset =",
                "            IF (",
                "                [SubstituteHoliday] > 0",
                "                    && NOT CONTAINS ( WorkingDays, [WorkingDayNumber], HolidayDay ),",
                "                VAR NextWorkingDay =",
                "                    MINX (",
                "                        FILTER ( WorkingDays, [WorkingDayNumber] > HolidayDay ),",
                "                        [WorkingDayNumber]",
                "                    )",
                "                VAR SubstituteDay =",
                "                    IF (",
                "                        ISBLANK ( NextWorkingDay ),",
                "                        MINX ( WorkingDays, [WorkingDayNumber] ) + 7,",
                "                        NextWorkingDay",
                "                    )",
                "                RETURN",
                "                    SubstituteDay - HolidayDay",
                "                        + ( [SubstituteHoliday] - 1 )",
                "            )",
                "        RETURN",
                "            ROW (",
                "                -- Use DATE function to get a DATE column as a result ",
                "                \"HolidayDate\", DATE ( YEAR ( HolidayDate ), MONTH ( HolidayDate ), DAY ( HolidayDate ) ),",
                "                \"SubstituteHolidayOffset\", SubstituteHolidayOffset",
                "            )",
                "    ) //",
                "VAR HolidayDates_RawDatesUnique = ",
                "    DISTINCT ( ",
                "        SELECTCOLUMNS ( ",
                "            HolidayDates_GeneratedRawWithDuplicates,",
                "            \"HolidayDateUnique\", [HolidayDate]",
                "        )",
                "    )",
                "VAR HolidayDates_GeneratedRaw = ",
                "    GENERATE (",
                "        HolidayDates_RawDatesUnique,",
                "        VAR FilterDate = [HolidayDateUnique]",
                "        RETURN ",
                "            TOPN (",
                "                1,",
                "                FILTER ( ",
                "                    HolidayDates_GeneratedRawWithDuplicates,",
                "                    [HolidayDate] = FilterDate",
                "                ),",
                "                [ConflictPriority],",
                "                ASC,",
                "                [HolidayName], ",
                "                ASC",
                "            )",
                "    )  ",
                "VAR HolidayDates_GeneratedSubstitutesOffset =",
                "    SELECTCOLUMNS (",
                "        FILTER ( HolidayDates_GeneratedRawWithDuplicates, [SubstituteHoliday] > 0 ),",
                "        \"Value\", [Value],",
                "        \"ISO Country\", [ISO Country],",
                "        \"MonthNumber\", [MonthNumber],",
                "        \"DayNumber\", [DayNumber],",
                "        \"WeekDayNumber\", [WeekDayNumber],",
                "        \"OffsetWeek\", [OffsetWeek],",
                "        \"HolidayName\", [HolidayName],",
                "        \"SubstituteHoliday\", [SubstituteHoliday],",
                "        \"ConflictPriority\", [ConflictPriority],",
                "        \"HolidayDate\", [HolidayDate],",
                "        \"SubstituteHolidayOffset\", ",
                "            VAR CurrentHolidayDate = [HolidayDate]",
                "            VAR CurrentHolidayName = [HolidayName]",
                "            VAR OriginalSubstituteDate = [HolidayDate] + [SubstituteHolidayOffset]",
                "            VAR OtherHolidays = ",
                "                FILTER ( ",
                "                    HolidayDates_GeneratedRawWithDuplicates, ",
                "                    [HolidayDate] <> CurrentHolidayDate",
                "                    || [HolidayName] <> CurrentHolidayName",
                "                )",
                "            VAR ConflictDay0 = ",
                "                CONTAINS ( ",
                "                    OtherHolidays,",
                "                    [HolidayDate], OriginalSubstituteDate",
                "                )",
                "            VAR ConflictDay1 = ",
                "                ConflictDay0 ",
                "                && CONTAINS ( ",
                "                    OtherHolidays,",
                "                    [HolidayDate], OriginalSubstituteDate + 1",
                "                )",
                "            VAR ConflictDay2 = ",
                "                ConflictDay1 ",
                "                && CONTAINS ( ",
                "                    OtherHolidays,",
                "                    [HolidayDate], OriginalSubstituteDate + 2",
                "                )",
                "            VAR SubstituteOffsetStep1 = [SubstituteHolidayOffset] + ConflictDay0 + ConflictDay1 + ConflictDay2",
                "            VAR HolidayDateStep1 = CurrentHolidayDate + SubstituteOffsetStep1",
                "            VAR HolidayDayStep1 =",
                "                WEEKDAY ( HolidayDateStep1, 1 ) - 1",
                "            VAR SubstituteHolidayOffsetNonWorkingDays =",
                "                IF (",
                "                    NOT CONTAINS ( WorkingDays, [WorkingDayNumber], HolidayDayStep1 ),",
                "                    VAR NextWorkingDayStep2 =",
                "                        MINX (",
                "                            FILTER ( WorkingDays, [WorkingDayNumber] > HolidayDayStep1 ),",
                "                            [WorkingDayNumber]",
                "                        )",
                "                    VAR SubstituteDay =",
                "                        IF (",
                "                            ISBLANK ( NextWorkingDayStep2 ),",
                "                            MINX ( WorkingDays, [WorkingDayNumber] ) + 7,",
                "                            NextWorkingDayStep2",
                "                        )",
                "                    RETURN SubstituteDay - HolidayDateStep1",
                "                )",
                "            VAR SubstituteOffsetStep2 = SubstituteOffsetStep1 + SubstituteHolidayOffsetNonWorkingDays",
                "            VAR SubstituteDateStep2 = OriginalSubstituteDate + SubstituteOffsetStep2",
                "            VAR ConflictDayStep2_0 = ",
                "                CONTAINS ( ",
                "                    OtherHolidays,",
                "                    [HolidayDate], SubstituteDateStep2",
                "                )",
                "            VAR ConflictDayStep2_1 = ",
                "                ConflictDayStep2_0",
                "                && CONTAINS ( ",
                "                    OtherHolidays,",
                "                    [HolidayDate], SubstituteDateStep2 + 1",
                "                )",
                "            VAR ConflictDayStep2_2 = ",
                "                ConflictDayStep2_1 ",
                "                && CONTAINS ( ",
                "                    OtherHolidays,",
                "                    [HolidayDate], SubstituteDateStep2 + 2",
                "                )",
                "            VAR FinalSubstituteHolidayOffset = ",
                "                SubstituteOffsetStep2 + ConflictDayStep2_0 + ConflictDayStep2_1 + ConflictDayStep2_2",
                "            RETURN",
                "                FinalSubstituteHolidayOffset",
                "        )",
                "VAR HolidayDates_GeneratedSubstitutesExpanded =",
                "    ADDCOLUMNS (",
                "        HolidayDates_GeneratedSubstitutesOffset,",
                "        \"ReplacementHolidayDate\", [HolidayDate] + [SubstituteHolidayOffset]",
                "    )",
                "VAR HolidayDates_GeneratedSubstitutesUnique =",
                "    DISTINCT ( ",
                "        SELECTCOLUMNS ( ",
                "            HolidayDates_GeneratedSubstitutesExpanded,",
                "            \"UniuqeReplacementHolidayDate\", [ReplacementHolidayDate]",
                "        )",
                "    )",
                "VAR HolidayDates_GeneratedSubstitutes =",
                "    GENERATE (",
                "        HolidayDates_GeneratedSubstitutesUnique,",
                "        TOPN (",
                "            1,",
                "            FILTER ( ",
                "                HolidayDates_GeneratedSubstitutesExpanded,",
                "                [UniuqeReplacementHolidayDate] = [ReplacementHolidayDate]",
                "            ),",
                "            [ConflictPriority],",
                "            ASC,",
                "            [HolidayName], ",
                "            ASC",
                "        )",
                "    )  ",
                "VAR HolidayDates_Generated =",
                "    UNION (",
                "        SELECTCOLUMNS (",
                "            HolidayDates_GeneratedRaw,",
                "            \"HolidayDate\", [HolidayDate],",
                "            \"HolidayName\", [HolidayName]",
                "        ),",
                "        SELECTCOLUMNS (",
                "            FILTER ( HolidayDates_GeneratedSubstitutes, [SubstituteHolidayOffset] <> 0 ), ",
                "            \"HolidayDate\", [HolidayDate] + [SubstituteHolidayOffset],",
                "            \"HolidayName\", InLieuOf_prefix & [HolidayName]",
                "                & InLieuOf_suffix",
                "        )",
                "    )",
                "-- Alternative way to express holidays: create a table with the list of the dates",
                "-- The following table should be used instead of HolidayDates_Generated in the following ",
                "-- HolidayDates variable if you want to use a fixed list of holidays",
                "VAR HolidayDates_US_ExplicitDates =",
                "    DATATABLE (",
                "        \"HolidayDate\", DATETIME,",
                "        \"HolidayName\", STRING,",
                "        {",
                "            { \"2008-01-01\", \"New Year's Day\" },",
                "            { \"2008-12-25\", \"Christmas Day\" },",
                "            -------------------------",
                "            { \"2008-11-27\", \"Thanksgiving Day\" },",
                "            { \"2009-11-26\", \"Thanksgiving Day\" },",
                "            { \"2010-11-25\", \"Thanksgiving Day\" },",
                "            { \"2011-11-24\", \"Thanksgiving Day\" },",
                "            { \"2012-11-22\", \"Thanksgiving Day\" },",
                "            { \"2013-11-28\", \"Thanksgiving Day\" },",
                "            { \"2014-11-27\", \"Thanksgiving Day\" },",
                "            { \"2015-11-26\", \"Thanksgiving Day\" },",
                "            { \"2016-11-24\", \"Thanksgiving Day\" },",
                "            { \"2017-11-23\", \"Thanksgiving Day\" },",
                "            { \"2018-11-22\", \"Thanksgiving Day\" },",
                "            { \"2019-11-28\", \"Thanksgiving Day\" },",
                "            { \"2020-11-26\", \"Thanksgiving Day\" }",
                "        }",
                "    )",
                "VAR HolidayDates =",
                "    SELECTCOLUMNS (",
                "        HolidayDates_Generated,",
                "        \"Date\", [HolidayDate],",
                "        \"Holiday Name\", [HolidayName]",
                "    ) //",
                "------------------------------------------------------------",
                "--  ",
                "-- End of Configuration",
                "--",
                "------------------------------------------------------------",
                "--  ",
                "-- The following variables define ",
                "-- the content of the calendar tables",
                "--",
                "------------------------------------------------------------",
                "------------------------------------------------------------",
                "VAR FirstDayCalendar =",
                "    DATE ( FirstYear - 1, 1, 1 )",
                "VAR LastDayCalendar =",
                "    DATE ( LastYear + 1, 12, 31 )",
                "VAR WeekDayCalculationType =",
                "    IF ( FirstDayOfWeek = 0, 7, FirstDayOfWeek )",
                "        + 10",
                "VAR OffsetFiscalYear = ",
                "    IF ( FiscalCalendarFirstMonth > 1, 1, 0 )",
                "VAR WeeklyFiscalPeriods =",
                "    GENERATE (",
                "        SELECTCOLUMNS (",
                "            GENERATESERIES ( FirstYear - OffsetFiscalYear, LastYear + OffsetFiscalYear, 1 ),",
                "            \"CalendarType\", \"Weekly\",",
                "            \"Fiscal YearNumber\", [Value]",
                "        ),",
                "        VAR StartFiscalYearNumber = [Fiscal YearNumber] - (OffsetFiscalYear * TypeStartFiscalYear)",
                "        VAR FirstDayCurrentYear =",
                "            DATE ( StartFiscalYearNumber, FiscalCalendarFirstMonth, 1 )",
                "        VAR FirstDayNextYear =",
                "            DATE ( StartFiscalYearNumber + 1, FiscalCalendarFirstMonth, 1 )",
                "        VAR DayOfWeekNumberCurrentYear =",
                "            WEEKDAY ( FirstDayCurrentYear, WeekDayCalculationType )",
                "        VAR OffsetStartCurrentFiscalYear =",
                "            SWITCH (",
                "                WeeklyType,",
                "                \"Last\", 1 - DayOfWeekNumberCurrentYear,",
                "                \"Nearest\", IF (",
                "                    DayOfWeekNumberCurrentYear >= 5,",
                "                    8 - DayOfWeekNumberCurrentYear,",
                "                    1 - DayOfWeekNumberCurrentYear",
                "                ),",
                "                ERROR ( \"Unkonwn WeeklyType definition\" )",
                "            )",
                "        VAR DayOfWeekNumberNextYear =",
                "            WEEKDAY ( FirstDayNextYear, WeekDayCalculationType )",
                "        VAR OffsetStartNextFiscalYear =",
                "            SWITCH (",
                "                WeeklyType,",
                "                \"Last\", - DayOfWeekNumberNextYear,",
                "                \"Nearest\", IF (",
                "                    DayOfWeekNumberNextYear >= 5,",
                "                    7 - DayOfWeekNumberNextYear,",
                "                    - DayOfWeekNumberNextYear",
                "                ),",
                "                ERROR ( \"Unkonwn WeeklyType definition : \" )",
                "            )",
                "        VAR FirstDayOfFiscalYear = FirstDayCurrentYear + OffsetStartCurrentFiscalYear",
                "        VAR LastDayOfFiscalYear = FirstDayNextYear + OffsetStartNextFiscalYear",
                "        RETURN",
                "            ROW ( \"FirstDayOfYear\", FirstDayOfFiscalYear,",
                "            \"LastDayOfYear\", LastDayOfFiscalYear )",
                "    )",
                "VAR CheckFirstDayOfWeek =",
                "    IF (",
                "        UseCustomFiscalPeriods && (NOT IgnoreWeeklyFiscalPeriods)",
                "        && WEEKDAY ( MINX ( CustomFiscalPeriods, [FirstDayOfYear] ), 1 )",
                "              <> ( FirstDayOfWeek + 1 ),",
                "        ERROR ( \"CustomFiscalPeriods table does not match FirstDayOfWeek setting\" ),",
                "        TRUE",
                "    )",
                "VAR CustomFiscalPeriodsWithType =",
                "    GENERATE (",
                "        ROW ( \"CalendarType\", \"Custom\" ),",
                "        FILTER ( CustomFiscalPeriods, CheckFirstDayOfWeek )",
                "    )",
                "VAR FiscalPeriods =",
                "    SELECTCOLUMNS (",
                "        FILTER (",
                "            UNION ( ",
                "                FILTER ( WeeklyFiscalPeriods, NOT IgnoreWeeklyFiscalPeriods ),",
                "                CustomFiscalPeriodsWithType ",
                "            ),",
                "            [CalendarType] = WeeklyCalendarType",
                "        ),",
                "        \"FW YearNumber\", [Fiscal YearNumber],",
                "        \"FW StartOfYear\", [FirstDayOfYear],",
                "        \"FW EndOfYear\", [LastDayOfYear]",
                "    )",
                "VAR WeeksInP1 =",
                "    SWITCH (",
                "        QuarterWeekType,",
                "        \"445\", 4,",
                "        \"454\", 4,",
                "        \"544\", 5,",
                "        ERROR ( \"QuarterWeekType only supports 445, 454, and 544\" )",
                "    )",
                "VAR WeeksInP2 =",
                "    SWITCH (",
                "        QuarterWeekType,",
                "        \"445\", 4,",
                "        \"454\", 5,",
                "        \"544\", 4,",
                "        ERROR ( \"QuarterWeekType only supports 445, 454, and 544\" )",
                "    )",
                "VAR WeeksInP3 =",
                "    SWITCH (",
                "        QuarterWeekType,",
                "        \"445\", 5,",
                "        \"454\", 4,",
                "        \"544\", 4,",
                "        ERROR ( \"QuarterWeekType only supports 445, 454, and 544\" )",
                "    )",
                "VAR FirstSundayReference =",
                "    DATE ( 1900, 12, 30 ) -- Do not change this ",
                "VAR FirstWeekReference = FirstSundayReference + FirstDayOfWeek",
                "VAR RawDays =",
                "    CALENDAR ( FirstDayCalendar, LastDayCalendar )",
                "VAR CalendarGregorianPrefixSpace =",
                "    IF ( CalendarGregorianPrefix <> \"\", CalendarGregorianPrefix & \" \", \"\" )",
                "VAR FiscalGregorianPrefixSpace =",
                "    IF ( FiscalGregorianPrefix <> \"\", FiscalGregorianPrefix & \" \", \"\" )",
                "VAR FiscalWeeklyPrefixSpace =",
                "    IF ( FiscalWeeklyPrefix <> \"\", FiscalWeeklyPrefix & \" \", \"\" )",
                "VAR CustomFiscalRawDays =",
                "    GENERATE ( FiscalPeriods, CALENDAR ( [FW StartOfYear], [FW EndOfYear] ) )",
                "VAR CalendarStandardGregorianBase =",
                "    GENERATE (",
                "        NATURALLEFTOUTERJOIN ( RawDays, HolidayDates ),",
                "        VAR CalDate = [Date]",
                "        VAR CalYear =",
                "            YEAR ( [Date] )",
                "        VAR CalMonthNumber =",
                "            MONTH ( [Date] )",
                "        VAR CalQuarterNumber =",
                "            ROUNDUP ( CalMonthNumber / 3, 0 )",
                "        VAR CalDay =",
                "            DAY ( [Date] )",
                "        VAR CalWeekNumber =",
                "            WEEKNUM ( CalDate, WeekDayCalculationType )",
                "        VAR CalDayOfMonth =",
                "            DAY ( CalDate )",
                "        VAR WeekDayNumber =",
                "            WEEKDAY ( CalDate, WeekDayCalculationType )",
                "        VAR YearWeekNumber =",
                "            INT ( DIVIDE ( CalDate - FirstWeekReference, 7 ) )",
                "        VAR CalendarFirstDayOfYear =",
                "            DATE ( CalYear, 1, 1 )",
                "        VAR CalendarDayOfYear =",
                "            INT ( CalDate - CalendarFirstDayOfYear + 1 )",
                "        VAR IsWorkingDay =",
                "            CONTAINS ( WorkingDays, [WorkingDayNumber], WEEKDAY ( CalDate, 1 ) - 1 )",
                "                && ISBLANK ( [Holiday Name] )",
                "        VAR _CheckLeapYearBefore =",
                "            CalYear -",
                "            IF ( (CalMonthNumber = 2 && CalDayOfMonth < 29)",
                "                     || CalMonthNumber < 2,",
                "                1,",
                "                0 )",
                "        VAR LeapYearsBefore1900 =",
                "            INT ( 1899 / 4 )",
                "                - INT ( 1899 / 100 )",
                "                + INT ( 1899 / 400 )",
                "        VAR LeapYearsBetween =",
                "            INT ( _CheckLeapYearBefore / 4 )",
                "                - INT ( _CheckLeapYearBefore / 100 )",
                "                + INT ( _CheckLeapYearBefore / 400 )",
                "                - LeapYearsBefore1900",
                "        VAR Sequential365DayNumber =",
                "            INT ( CalDate - LeapYearsBetween ) ",
                "        RETURN",
                "            ROW (",
                "                \"DateKey\", CalYear * 10000",
                "                    + CalMonthNumber * 100",
                "                    + CalDay,",
                "                \"Calendar YearNumber\", CalYear,",
                "                \"Calendar Year\", CalendarGregorianPrefixSpace & CalYear,",
                "                \"Calendar QuarterNumber\", CalQuarterNumber,",
                "                \"Calendar Quarter\", CalendarGregorianPrefix & \"Q\"",
                "                    & CalQuarterNumber",
                "                    & \" \",",
                "                \"Calendar YearQuarterNumber\", CalYear * 4",
                "                    - 1",
                "                    + CalQuarterNumber,",
                "                \"Calendar Quarter Year\", CalendarGregorianPrefix & \"Q\"",
                "                    & CalQuarterNumber",
                "                    & \" \"",
                "                    & CalYear,",
                "                \"Calendar MonthNumber\", CalMonthNumber,",
                "                \"Calendar Month\", FORMAT ( CalDate, \"mmm\" ),",
                "                \"Calendar YearMonthNumber\", CalYear * 12",
                "                    - 1",
                "                    + CalMonthNumber,",
                "                \"Calendar Month Year\", FORMAT ( CalDate, \"mmm\" ) & \" \"",
                "                    & CalYear,",
                "                \"Calendar WeekNumber\", CalWeekNumber,",
                "                \"Calendar Week\", CalendarGregorianPrefix & \"W\"",
                "                    & FORMAT ( CalWeekNumber, \"00\" ),",
                "                \"Calendar YearWeekNumber\", YearWeekNumber,",
                "                \"Calendar Week Year\", CalendarGregorianPrefix & \"W\"",
                "                    & FORMAT ( CalWeekNumber, \"00\" )",
                "                    & \"-\"",
                "                    & CalYear,",
                "                \"Calendar WeekYearOrder\", CalYear * 100",
                "                    + CalWeekNumber,",
                "                \"Calendar DayOfYearNumber\", CalendarDayOfYear,",
                "                \"Day of Month\", CalDayOfMonth,",
                "                \"WeekDayNumber\", WeekDayNumber,",
                "                \"Week Day\", FORMAT ( CalDate, \"ddd\" ),",
                "                \"IsWorkingDay\", IsWorkingDay,",
                "                \"Day Type\", IF ( IsWorkingDay, WorkingDayType, NonWorkingDayType ),",
                "                \"Sequential365DayNumber\", Sequential365DayNumber",
                "            )",
                "    )",
                "VAR CalendarStandardGregorian =",
                "    GENERATE (",
                "        CalendarStandardGregorianBase,",
                "        VAR CalDate = [Date]",
                "        VAR YearNumber = [Calendar YearNumber]",
                "        VAR MonthNumber = [Calendar MonthNumber]",
                "        VAR YearWeekNumber = [Calendar YearWeekNumber]",
                "        VAR YearMonthNumber = [Calendar YearMonthNumber]",
                "        VAR YearQuarterNumber = [Calendar YearQuarterNumber]",
                "        VAR CurrentWeekPos =",
                "            AVERAGEX (",
                "                FILTER ( CalendarStandardGregorianBase, [Date] = TodayReference ),",
                "                [Calendar YearWeekNumber]",
                "            )",
                "        VAR CurrentMonthPos =",
                "            AVERAGEX (",
                "                FILTER ( CalendarStandardGregorianBase, [Date] = TodayReference ),",
                "                [Calendar YearMonthNumber]",
                "            )",
                "        VAR CurrentQuarterPos =",
                "            AVERAGEX (",
                "                FILTER ( CalendarStandardGregorianBase, [Date] = TodayReference ),",
                "                [Calendar YearQuarterNumber]",
                "            )",
                "        VAR CurrentYearPos =",
                "            AVERAGEX (",
                "                FILTER ( CalendarStandardGregorianBase, [Date] = TodayReference ),",
                "                [Calendar YearNumber]",
                "            )",
                "        VAR RelativeWeekPos = CurrentWeekPos - YearWeekNumber",
                "        VAR RelativeMonthPos = CurrentMonthPos - YearMonthNumber",
                "        VAR RelativeQuarterPos = CurrentQuarterPos - YearQuarterNumber",
                "        VAR RelativeYearPos = CurrentYearPos - YearNumber",
                "        VAR CalStartOfMonth =",
                "            DATE ( YearNumber, MonthNumber, 1 )",
                "        VAR CalEndOfMonth =",
                "            EOMONTH ( CalDate, 0 )",
                "        VAR CalMonthDays = ",
                "            INT ( CalEndOfMonth - CalStartOfMonth + 1 ) ",
                "        VAR CalDayOfMonthNumber =",
                "            INT ( CalDate - CalStartOfMonth + 1 )",
                "        VAR CalStartOfQuarter =",
                "            MINX (",
                "                FILTER (",
                "                    CalendarStandardGregorianBase,",
                "                    [Calendar YearQuarterNumber] = YearQuarterNumber",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR CalEndOfQuarter =",
                "            MAXX (",
                "                FILTER (",
                "                    CalendarStandardGregorianBase,",
                "                    [Calendar YearQuarterNumber] = YearQuarterNumber",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR CalQuarterDays =",
                "            INT ( CalEndOfQuarter - CalStartOfQuarter + 1 )         ",
                "        VAR CalDayOfQuarterNumber =",
                "            INT ( CalDate - CalStartOfQuarter + 1 )",
                "        VAR CalYearDays =",
                "            INT ( DATE ( YearNumber, 12, 31 ) - DATE ( YearNumber, 1, 1 ) + 1 )",
                "        VAR CalDatePreviousWeek = CalDate - 7",
                "        VAR CalDatePreviousMonth = ",
                "            MAXX (",
                "                FILTER (",
                "                    CalendarStandardGregorianBase,",
                "                    [Calendar YearMonthNumber] = YearMonthNumber - 1",
                "                    &&",
                "                    ( [Day of Month] <= CalDayOfMonthNumber",
                "                      || CalDayOfMonthNumber = CalMonthDays )",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR CalDatePreviousQuarter = ",
                "            MAXX (",
                "                FILTER (",
                "                    CalendarStandardGregorianBase,",
                "                    [Calendar YearMonthNumber] = YearMonthNumber - 3",
                "                    &&",
                "                    ( [Day of Month] <= CalDayOfMonthNumber",
                "                      || CalDayOfMonthNumber = CalMonthDays )",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR CalDatePreviousYear = ",
                "            MAXX (",
                "                FILTER (",
                "                    CalendarStandardGregorianBase,",
                "                    [Calendar YearMonthNumber] = YearMonthNumber - 12",
                "                    &&",
                "                    ( [Day of Month] <= CalDayOfMonthNumber",
                "                      || CalDayOfMonthNumber = CalMonthDays )",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR CalStartOfYear =",
                "            DATE ( YearNumber, 1, 1 )",
                "        VAR CalEndOfYear =",
                "            DATE ( YearNumber, 12, 31 )",
                "        RETURN",
                "            ROW ( \"Calendar RelativeWeekPos\", RelativeWeekPos,",
                "            \"Calendar RelativeMonthPos\", RelativeMonthPos,",
                "            \"Calendar RelativeQuarterPos\", RelativeQuarterPos,",
                "            \"Calendar RelativeYearPos\", RelativeYearPos,",
                "            \"Calendar StartOfMonth\", CalStartOfMonth,",
                "            \"Calendar EndOfMonth\", CalEndOfMonth,",
                "            \"Calendar DayOfMonthNumber\", CalDayOfMonthNumber,",
                "            \"Calendar StartOfQuarter\", CalStartOfQuarter,",
                "            \"Calendar EndOfQuarter\", CalEndOfQuarter,",
                "            \"Calendar DayOfQuarterNumber\", CalDayOfQuarterNumber,            ",
                "            \"Calendar StartOfYear\", CalStartOfYear,",
                "            \"Calendar EndOfYear\", CalEndOfYear,",
                "            \"Calendar DatePreviousWeek\", CalDatePreviousWeek,",
                "            \"Calendar DatePreviousMonth\", CalDatePreviousMonth,",
                "            \"Calendar DatePreviousQuarter\", CalDatePreviousQuarter,",
                "            \"Calendar DatePreviousYear\", CalDatePreviousYear,",
                "            \"Calendar MonthDays\", CalMonthDays,",
                "            \"Calendar QuarterDays\", CalQuarterDays,",
                "            \"Calendar YearDays\", CalYearDays",
                "            )",
                "    )",
                "VAR FiscalStandardGregorianBase =",
                "    GENERATE (",
                "        NATURALLEFTOUTERJOIN ( RawDays, HolidayDates ),",
                "        VAR FiscalDate = [Date]",
                "        VAR CalYear =",
                "            YEAR ( FiscalDate )",
                "        VAR CalMonthNumber =",
                "            MONTH ( FiscalDate )",
                "        VAR CalDay =",
                "            DAY ( [Date] )",
                "        VAR WeekDayNumber =",
                "            WEEKDAY ( FiscalDate, WeekDayCalculationType )",
                "        VAR YearWeekNumber =",
                "            INT ( DIVIDE ( FiscalDate - FirstWeekReference, 7 ) )",
                "        VAR FiscalYear =",
                "            CalYear ",
                "                + IF ( FiscalCalendarFirstMonth > 1,",
                "                      IF ( CalMonthNumber >= FiscalCalendarFirstMonth, ",
                "                          TypeStartFiscalYear,                     -- TypeStartFiscalYear = 1",
                "                          -1 * (TypeStartFiscalYear = 0)           -- TypeStartFiscalYear = 0",
                "                      )",
                "                  )",
                "        VAR FiscalMonthNumber =",
                "            MOD ( CalMonthNumber - FiscalCalendarFirstMonth, 12 )",
                "                + 1",
                "        VAR FiscalFirstDayOfYear =",
                "            DATE ( FiscalYear - (OffsetFiscalYear * TypeStartFiscalYear), FiscalCalendarFirstMonth, 1 )",
                "        VAR FiscalDayOfYear =",
                "            INT ( FiscalDate - FiscalFirstDayOfYear + 1 )",
                "        VAR FiscalFirstYearWeekNumber =",
                "            INT ( DIVIDE ( FiscalFirstDayOfYear - FirstWeekReference, 7 ) )",
                "        VAR FiscalWeekNumber = YearWeekNumber - FiscalFirstYearWeekNumber",
                "            + 1",
                "        VAR FiscalQuarterNumber =",
                "            ROUNDUP ( FiscalMonthNumber / 3, 0 )",
                "        VAR IsWorkingDay =",
                "            CONTAINS ( WorkingDays, [WorkingDayNumber], WEEKDAY ( FiscalDate, 1 ) - 1 )",
                "                && ISBLANK ( [Holiday Name] )",
                "        RETURN",
                "            ROW (",
                "                \"DateKey\", CalYear * 10000",
                "                    + CalMonthNumber * 100",
                "                    + CalDay,",
                "                \"Fiscal Year\", FiscalGregorianPrefixSpace & FiscalYear,",
                "                \"Fiscal YearNumber\", FiscalYear,",
                "                \"Fiscal QuarterNumber\", FiscalQuarterNumber,",
                "                \"Fiscal Quarter\", FiscalGregorianPrefix & \"Q\"",
                "                    & FiscalQuarterNumber",
                "                    & \" \",",
                "                \"Fiscal YearQuarterNumber\", FiscalYear * 4",
                "                    - 1",
                "                    + FiscalQuarterNumber,",
                "                \"Fiscal Quarter Year\", FiscalGregorianPrefix & \"Q\"",
                "                    & FiscalQuarterNumber",
                "                    & \" \"",
                "                    & FiscalYear,",
                "                \"Fiscal MonthNumber\", FiscalMonthNumber,",
                "                \"Fiscal Month\", FORMAT ( FiscalDate, \"mmm\" ),",
                "                \"Fiscal YearMonthNumber\", FiscalYear * 12",
                "                    - 1",
                "                    + FiscalMonthNumber,",
                "                \"Fiscal Month Year\", FORMAT ( FiscalDate, \"mmm\" ) & \" \"",
                "                    & CalYear,",
                "                \"Fiscal WeekNumber\", FiscalWeekNumber,",
                "                \"Fiscal Week\", FiscalGregorianPrefix & \"W\"",
                "                    & FORMAT ( FiscalWeekNumber, \"00\" ),",
                "                \"Fiscal YearWeekNumber\", YearWeekNumber,",
                "                \"Fiscal Week Year\", FiscalGregorianPrefix & \"W\"",
                "                    & FORMAT ( FiscalWeekNumber, \"00\" )",
                "                    & \"-\"",
                "                    & FiscalYear,",
                "                \"Fiscal WeekYearOrder\", FiscalYear * 100",
                "                    + FiscalWeekNumber,",
                "                \"Fiscal DayOfYearNumber\", FiscalDayOfYear,",
                "                \"Day of Month\", DAY ( FiscalDate ),",
                "                \"WeekDayNumber\", WeekDayNumber,",
                "                \"Week Day\", FORMAT ( FiscalDate, \"ddd\" ),",
                "                \"IsWorkingDay\", IsWorkingDay,",
                "                \"Day Type\", IF ( IsWorkingDay, WorkingDayType, NonWorkingDayType )",
                "            )",
                "    )",
                "VAR FiscalStandardGregorian =",
                "    GENERATE (",
                "        FiscalStandardGregorianBase,",
                "        VAR FiscalDate = [Date]",
                "        VAR FiscalYearNumber = [Fiscal YearNumber]",
                "        VAR MonthNumber = [Fiscal MonthNumber]",
                "        VAR CalendarYearNumber =",
                "            YEAR ( FiscalDate )",
                "        VAR CalendarMonthNumber =",
                "            MONTH ( FiscalDate )",
                "        VAR YearWeekNumber = [Fiscal YearWeekNumber]",
                "        VAR YearMonthNumber = [Fiscal YearMonthNumber]",
                "        VAR YearQuarterNumber = [Fiscal YearQuarterNumber]",
                "        VAR CurrentWeekPos =",
                "            AVERAGEX (",
                "                FILTER ( FiscalStandardGregorianBase, [Date] = TodayReference ),",
                "                [Fiscal YearWeekNumber]",
                "            )",
                "        VAR CurrentMonthPos =",
                "            AVERAGEX (",
                "                FILTER ( FiscalStandardGregorianBase, [Date] = TodayReference ),",
                "                [Fiscal YearMonthNumber]",
                "            )",
                "        VAR CurrentQuarterPos =",
                "            AVERAGEX (",
                "                FILTER ( FiscalStandardGregorianBase, [Date] = TodayReference ),",
                "                [Fiscal YearQuarterNumber]",
                "            )",
                "        VAR CurrentYearPos =",
                "            AVERAGEX (",
                "                FILTER ( FiscalStandardGregorianBase, [Date] = TodayReference ),",
                "                [Fiscal YearNumber]",
                "            )",
                "        VAR RelativeWeekPos = CurrentWeekPos - YearWeekNumber",
                "        VAR RelativeMonthPos = CurrentMonthPos - YearMonthNumber",
                "        VAR RelativeQuarterPos = CurrentQuarterPos - YearQuarterNumber",
                "        VAR RelativeYearPos = CurrentYearPos - FiscalYearNumber",
                "        VAR FiscalStartOfMonth =",
                "            DATE ( CalendarYearNumber, CalendarMonthNumber, 1 )",
                "        VAR FiscalEndOfMonth =",
                "            EOMONTH ( FiscalDate, 0 )",
                "        VAR FiscalMonthDays = ",
                "            INT ( FiscalEndOfMonth - FiscalStartOfMonth + 1 ) ",
                "        VAR FiscalDayOfMonthNumber =",
                "            INT ( FiscalDate - FiscalStartOfMonth + 1 )",
                "        VAR FiscalStartOfQuarter =",
                "            MINX (",
                "                FILTER (",
                "                    FiscalStandardGregorianBase,",
                "                    [Fiscal YearQuarterNumber] = YearQuarterNumber",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR FiscalEndOfQuarter =",
                "            MAXX (",
                "                FILTER (",
                "                    FiscalStandardGregorianBase,",
                "                    [Fiscal YearQuarterNumber] = YearQuarterNumber",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR FiscalQuarterDays = ",
                "            INT ( FiscalEndOfQuarter - FiscalStartOfQuarter + 1 )",
                "        VAR FiscalFirstDayOfYear =",
                "            DATE ( FiscalYearNumber - OffsetFiscalYear, FiscalCalendarFirstMonth, 1 )",
                "        VAR FiscalLastDayOfYear =",
                "            DATE ( FiscalYearNumber + (1 * (OffsetFiscalYear = 0)), FiscalCalendarFirstMonth, 1 ) - 1",
                "        VAR FiscalYearDays = ",
                "            INT ( FiscalLastDayOfYear - FiscalFirstDayOfYear + 1 ) ",
                "        VAR FiscalDayOfQuarterNumber =",
                "            INT ( FiscalDate - FiscalStartOfQuarter + 1 )",
                "        VAR FiscalStartOfYear =",
                "            MINX (",
                "                FILTER (",
                "                    FiscalStandardGregorianBase,",
                "                    [Fiscal YearNumber] = FiscalYearNumber",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR FiscalEndOfYear =",
                "            MAXX (",
                "                FILTER (",
                "                    FiscalStandardGregorianBase,",
                "                    [Fiscal YearNumber] = FiscalYearNumber",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR FiscalDatePreviousWeek = FiscalDate - 7",
                "        VAR FiscalDatePreviousMonth = ",
                "            MAXX (",
                "                FILTER (",
                "                    FiscalStandardGregorianBase,",
                "                    [Fiscal YearMonthNumber] = YearMonthNumber - 1",
                "                    &&",
                "                    ( [Day of Month] <= FiscalDayOfMonthNumber",
                "                      || FiscalDayOfMonthNumber = FiscalMonthDays )",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR FiscalDatePreviousQuarter = ",
                "            MAXX (",
                "                FILTER (",
                "                    FiscalStandardGregorianBase,",
                "                    [Fiscal YearMonthNumber] = YearMonthNumber - 3",
                "                    &&",
                "                    ( [Day of Month] <= FiscalDayOfMonthNumber",
                "                      || FiscalDayOfMonthNumber = FiscalMonthDays )",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR FiscalDatePreviousYear = ",
                "            MAXX (",
                "                FILTER (",
                "                    FiscalStandardGregorianBase,",
                "                    [Fiscal YearMonthNumber] = YearMonthNumber - 12",
                "                    &&",
                "                    ( [Day of Month] <= FiscalDayOfMonthNumber",
                "                      || FiscalDayOfMonthNumber = FiscalMonthDays )",
                "                ),",
                "                [Date]",
                "            )",
                "        RETURN",
                "            ROW ( \"Fiscal RelativeWeekPos\", RelativeWeekPos,",
                "            \"Fiscal RelativeMonthPos\", RelativeMonthPos,",
                "            \"Fiscal RelativeQuarterPos\", RelativeQuarterPos,",
                "            \"Fiscal RelativeYearPos\", RelativeYearPos,",
                "            \"Fiscal StartOfMonth\", FiscalStartOfMonth,",
                "            \"Fiscal EndOfMonth\", FiscalEndOfMonth,",
                "            \"Fiscal DayOfMonthNumber\", FiscalDayOfMonthNumber,",
                "            \"Fiscal StartOfQuarter\", FiscalStartOfQuarter,",
                "            \"Fiscal EndOfQuarter\", FiscalEndOfQuarter,",
                "            \"Fiscal DayOfQuarterNumber\", FiscalDayOfQuarterNumber,",
                "            \"Fiscal StartOfYear\", FiscalStartOfYear,",
                "            \"Fiscal EndOfYear\", FiscalEndOfYear,",
                "            \"Fiscal DatePreviousWeek\", FiscalDatePreviousWeek,",
                "            \"Fiscal DatePreviousMonth\", FiscalDatePreviousMonth,",
                "            \"Fiscal DatePreviousQuarter\", FiscalDatePreviousQuarter,",
                "            \"Fiscal DatePreviousYear\", FiscalDatePreviousYear,",
                "            \"Fiscal MonthDays\", FiscalMonthDays,",
                "            \"Fiscal QuarterDays\", FiscalQuarterDays,",
                "            \"Fiscal YearDays\", FiscalYearDays",
                "           )",
                "    )",
                "VAR FiscalWeeksBase =",
                "    GENERATE (",
                "        NATURALLEFTOUTERJOIN ( CustomFiscalRawDays, HolidayDates ),",
                "        VAR CalDate = [Date]",
                "        VAR FwFirstDayOfYear = [FW StartOfYear]",
                "        VAR FwDayOfYear =",
                "            INT ( CalDate - FwFirstDayOfYear + 1 )",
                "        VAR CalYear =",
                "            YEAR ( [Date] )",
                "        VAR CalMonthNumber =",
                "            MONTH ( [Date] )",
                "        VAR CalDay =",
                "            DAY ( [Date] )",
                "        VAR FwDayOfYearNumber = CalDate - [FW StartOfYear]",
                "            + 1",
                "        VAR FwWeekNumber =",
                "            INT ( CEILING ( FwDayOfYearNumber / 7, 1 ) )",
                "        VAR FwPeriodNumber = ",
                "            IF ( FwWeekNumber > 52, 14, ROUNDUP ( FwWeekNumber / 4, 0 ) )",
                "        VAR FwYearNumber = [FW YearNumber]",
                "        VAR FwQuarterNumber =",
                "            IF ( FwWeekNumber > 52, 4, ROUNDUP ( FwWeekNumber / 13, 0 ) )",
                "        VAR FwWeekInQuarterNumber =",
                "            IF ( FwWeekNumber > 52, 14, FwWeekNumber - 13 * ( FwQuarterNumber - 1 ) )",
                "        VAR FwMonthNumber =",
                "            ( FwQuarterNumber - 1 )",
                "                * 3",
                "                + SWITCH (",
                "                    TRUE,",
                "                    FwWeekInQuarterNumber <= WeeksInP1, 1,",
                "                    FwWeekInQuarterNumber",
                "                        <= ( WeeksInP1 + WeeksInP2 ), 2,",
                "                    3",
                "                )",
                "        VAR WeekDayNumber =",
                "            WEEKDAY ( CalDate, WeekDayCalculationType )",
                "        VAR FirstDayOfWeek = [Date] - WeekDayNumber",
                "            + 1",
                "        VAR LastDayOfWeek = FirstDayOfWeek + 6",
                "        VAR IsWorkingDay =",
                "            CONTAINS ( WorkingDays, [WorkingDayNumber], WEEKDAY ( CalDate, 1 ) - 1 )",
                "                && ISBLANK ( [Holiday Name] )",
                "        RETURN",
                "            ROW (",
                "                \"DateKey\", CalYear * 10000",
                "                    + CalMonthNumber * 100",
                "                    + CalDay,",
                "                // \"FW YearNumber\", FwYearNumber, -- It is already in the first set of columns of the GENERATE function",
                "                \"FW Year\", FiscalWeeklyPrefixSpace & FwYearNumber,",
                "                \"FW QuarterNumber\", FwQuarterNumber,",
                "                \"FW Quarter\", FiscalWeeklyPrefix & \"Q\"",
                "                    & FwQuarterNumber,",
                "                \"FW YearQuarterNumber\", FwYearNumber * 4",
                "                    - 1",
                "                    + FwQuarterNumber,",
                "                \"FW Quarter Year\", FiscalWeeklyPrefix & \"Q\"",
                "                    & FwQuarterNumber",
                "                    & \" \"",
                "                    & FwYearNumber,",
                "                \"FW MonthNumber\", FwMonthNumber,",
                "                \"FW Month\", FiscalWeeklyPrefix & \"P\"",
                "                    & FORMAT ( FwMonthNumber, \"00\" ),",
                "                \"FW YearMonthNumber\", FwYearNumber * 12",
                "                    - 1",
                "                    + FwMonthNumber,",
                "                \"FW Month Year\", FiscalWeeklyPrefix & \"P\"",
                "                    & FORMAT ( FwMonthNumber, \"00\" )",
                "                    & \" \"",
                "                    & FwYearNumber,",
                "                \"FW WeekNumber\", FwWeekNumber,",
                "                \"FW Week\", FiscalWeeklyPrefix & \"W\"",
                "                    & FORMAT ( FwWeekNumber, \"00\" ),",
                "                \"FW PeriodNumber\", FwPeriodNumber,",
                "                \"FW Period\", FiscalWeeklyPrefix & \"P\"",
                "                    & FORMAT ( FwPeriodNumber, \"00\" ),",
                "                \"FW YearWeekNumber\", INT ( DIVIDE ( CalDate - FirstWeekReference, 7 ) )",
                "                    + 1,",
                "                \"FW Week Year\", FiscalWeeklyPrefix & \"W\"",
                "                    & FORMAT ( FwWeekNumber, \"00\" )",
                "                    & \" \"",
                "                    & FwYearNumber,",
                "                \"FW StartOfWeek\", FirstDayOfWeek,",
                "                \"FW EndOfWeek\", LastDayOfWeek,",
                "                \"WeekDayNumber\", WeekDayNumber,",
                "                \"Week Day\", FORMAT ( CalDate, \"ddd\" ),",
                "                \"FW DayOfYearNumber\", FwDayOfYear,",
                "                \"IsWorkingDay\", IsWorkingDay,",
                "                \"Day Type\", IF ( IsWorkingDay, WorkingDayType, NonWorkingDayType )",
                "            )",
                "    )",
                "VAR FiscalWeeks_Pre = ",
                "    GENERATE (",
                "        FiscalWeeksBase,",
                "        VAR CalDate = [Date]",
                "        VAR FWYearNumber = [FW YearNumber]",
                "        VAR FwYearWeekNumber = [FW YearWeekNumber]",
                "        VAR FwYearMonthNumber = [FW YearMonthNumber]",
                "        VAR FwYearQuarterNumber = [FW YearQuarterNumber]",
                "        VAR CurrentWeekPos =",
                "            AVERAGEX (",
                "                FILTER ( FiscalWeeksBase, [Date] = TodayReference ),",
                "                [FW YearWeekNumber]",
                "            )",
                "        VAR CurrentMonthPos =",
                "            AVERAGEX (",
                "                FILTER ( FiscalWeeksBase, [Date] = TodayReference ),",
                "                [FW YearMonthNumber]",
                "            )",
                "        VAR CurrentQuarterPos =",
                "            AVERAGEX (",
                "                FILTER ( FiscalWeeksBase, [Date] = TodayReference ),",
                "                [FW YearQuarterNumber]",
                "            )",
                "        VAR CurrentYearPos =",
                "            AVERAGEX (",
                "                FILTER ( FiscalWeeksBase, [Date] = TodayReference ),",
                "                [FW YearNumber]",
                "            )",
                "        VAR RelativeWeekPos = CurrentWeekPos - FwYearWeekNumber",
                "        VAR RelativeMonthPos = CurrentMonthPos - FwYearMonthNumber",
                "        VAR RelativeQuarterPos = CurrentQuarterPos - FwYearQuarterNumber",
                "        VAR RelativeYearPos = CurrentYearPos - FwYearNumber",
                "        VAR FwStartOfMonth =",
                "            MINX (",
                "                FILTER ( FiscalWeeksBase, [FW YearMonthNumber] = FwYearMonthNumber ),",
                "                [Date]",
                "            )",
                "        VAR FwEndOfMonth =",
                "            MAXX (",
                "                FILTER ( FiscalWeeksBase, [FW YearMonthNumber] = FwYearMonthNumber ),",
                "                [Date]",
                "            )",
                "        VAR FwMonthDays = ",
                "            INT ( FwEndOfMonth - FwStartOfMonth + 1 ) ",
                "        VAR FwDayOfMonthNumber =",
                "            INT ( CalDate - FwStartOfMonth + 1 )",
                "        VAR FwStartOfQuarter =",
                "            MINX (",
                "                FILTER ( FiscalWeeksBase, [FW YearQuarterNumber] = FwYearQuarterNumber ),",
                "                [Date]",
                "            )",
                "        VAR FwEndOfQuarter =",
                "            MAXX (",
                "                FILTER ( FiscalWeeksBase, [FW YearQuarterNumber] = FwYearQuarterNumber ),",
                "                [Date]",
                "            )",
                "        VAR FwQuarterDays = ",
                "            INT ( FwEndOfQuarter - FwStartOfQuarter + 1 )",
                "        VAR FwDayOfQuarterNumber =",
                "            INT ( CalDate - FwStartOfQuarter + 1 )",
                "        VAR FwStartOfYear =",
                "            MINX (",
                "                FILTER ( FiscalWeeksBase, [FW YearNumber] = FwYearNumber ),",
                "                [Date]",
                "            )",
                "        VAR FwEndOfYear =",
                "            MAXX (",
                "                FILTER ( FiscalWeeksBase, [FW YearNumber] = FwYearNumber ),",
                "                [Date]",
                "            )",
                "        VAR FwYearDays = ",
                "            INT ( FwEndOfYear - FwStartOfYear + 1 )",
                "        RETURN",
                "            ROW ( \"FW RelativeWeekPos\", RelativeWeekPos,",
                "            \"FW RelativeMonthPos\", RelativeMonthPos,",
                "            \"FW RelativeQuarterPos\", RelativeQuarterPos,",
                "            \"FW RelativeYearPos\", RelativeYearPos,",
                "            \"FW StartOfMonth\", FwStartOfMonth,",
                "            \"FW EndOfMonth\", FwEndOfMonth,",
                "            \"FW DayOfMonthNumber\", FwDayOfMonthNumber,",
                "            \"FW StartOfQuarter\", FwStartOfQuarter,",
                "            \"FW EndOfQuarter\", FwEndOfQuarter,",
                "            \"FW DayOfQuarterNumber\", FwDayOfQuarterNumber,",
                "            \"FW MonthDays\", FwMonthDays,",
                "            \"FW QuarterDays\", FwQuarterDays,",
                "            \"FW YearDays\", FwYearDays   ",
                "            )",
                "    )",
                "VAR FiscalWeeks =",
                "    GENERATE (",
                "        FiscalWeeks_Pre,",
                "        VAR CalDate = [Date]",
                "        VAR FwYearMonthNumber = [FW YearMonthNumber]",
                "        VAR FwYearQuarterNumber = [FW YearQuarterNumber]",
                "        VAR FWYearNumber = [FW YearNumber]",
                "        VAR FwDayOfMonthNumber = [FW DayOfMonthNumber]",
                "        VAR FwDayOfQuarterNumber = [FW DayOfQuarterNumber]",
                "        VAR FwDayOfYearNumber = [FW DayOfYearNumber]",
                "        VAR FwMonthDays = [FW EndOfMonth] - [FW StartOfMonth] + 1 ",
                "        VAR FwQuarterDays = [FW EndOfQuarter] - [FW StartOfQuarter] + 1 ",
                "        VAR FwYearDays = [FW EndOfYear] - [FW StartOfYear] + 1 ",
                "        VAR FwDatePreviousWeek = CalDate - 7",
                "        VAR FwDatePreviousMonth = ",
                "            MAXX (",
                "                FILTER (",
                "                    FiscalWeeks_Pre,",
                "                    [Fw YearMonthNumber] = FwYearMonthNumber - 1",
                "                    &&",
                "                    ( [FW DayOfMonthNumber] <= FwDayOfMonthNumber",
                "                      || FwDayOfMonthNumber = FwMonthDays )",
                "                ),",
                "                [Date]",
                "            )",
                "        VAR FwDatePreviousQuarter = ",
                "            MAXX (",
                "                FILTER (",
                "                    FiscalWeeks_Pre,",
                "                    [Fw YearQuarterNumber] = FwYearQuarterNumber - 1",
                "                    &&",
                "                    ( [FW DayOfQuarterNumber] <= FwDayOfQuarterNumber",
                "                      || FwDayOfQuarterNumber = FwQuarterDays )",
                "                ),",
                "                [Date]",
                "            )        ",
                "        VAR FwDatePreviousYear = ",
                "            MAXX (",
                "                FILTER (",
                "                    FiscalWeeks_Pre,",
                "                    [Fw YearNumber] = FWYearNumber - 1",
                "                    &&",
                "                    ( [FW DayOfYearNumber] <= FwDayOfYearNumber",
                "                      || FwDayOfYearNumber = FwYearDays )",
                "                ),",
                "                [Date]",
                "            )",
                "        RETURN",
                "            ROW ( ",
                "                \"FW DatePreviousWeek\", FwDatePreviousWeek,",
                "                \"FW DatePreviousMonth\", FwDatePreviousMonth,",
                "                \"FW DatePreviousQuarter\", FwDatePreviousQuarter,",
                "                \"FW DatePreviousYear\", FwDatePreviousYear         ",
                "            )",
                "    )",
                "    ",
                "VAR CompleteCalendarExpanded =",
                "    NATURALLEFTOUTERJOIN (",
                "        FiscalStandardGregorian,",
                "        NATURALLEFTOUTERJOIN ( CalendarStandardGregorian, FiscalWeeks )",
                "    )",
                "VAR CompleteCalendar = ",
                "    FILTER (",
                "        CompleteCalendarExpanded,",
                "        ( [Calendar YearNumber] >= FirstYear && [Calendar YearNumber] <= LastYear && CalendarRange = \"Calendar\" )",
                "        ||",
                "        ( [Fiscal YearNumber] >= FirstYear && [Fiscal YearNumber] <= LastYear && CalendarRange = \"FiscalGregorian\" )",
                "        ||",
                "        ( [FW YearNumber] >= FirstYear && [FW YearNumber] <= LastYear && CalendarRange = \"FiscalWeekly\" )",
                "    )",
                "    ",
                "VAR Result =",
                "    SELECTCOLUMNS (",
                "        CompleteCalendar,",
                "        ",
                "        -- Base date columns",
                "        \"Date\", [Date],",
                "        \"DateKey\", [DateKey],",
                "",
                "        \"Day of Month\", [Day of Month],",
                "        \"WeekDayNumber\", [WeekDayNumber],",
                "",
                "        \"Week Day\", [Week Day],",
                "        \"Sequential365DayNumber\", [Sequential365DayNumber],",
                "        ",
                "        -- Calendar = Solar Calendar (January-December)",
                "        \"Calendar YearNumber\", [Calendar YearNumber],",
                "        \"Calendar Year\", [Calendar Year],",
                "        \"Calendar QuarterNumber\", [Calendar QuarterNumber],",
                "        \"Calendar Quarter\", [Calendar Quarter],",
                "        \"Calendar YearQuarterNumber\", [Calendar YearQuarterNumber],",
                "        \"Calendar Quarter Year\", [Calendar Quarter Year],",
                "        \"Calendar MonthNumber\", [Calendar MonthNumber],",
                "        \"Calendar Month\", [Calendar Month],",
                "        \"Calendar YearMonthNumber\", [Calendar YearMonthNumber],",
                "        \"Calendar Month Year\", [Calendar Month Year],",
                "        \"Calendar WeekNumber\", [Calendar WeekNumber],",
                "        \"Calendar Week\", [Calendar Week],",
                "        \"Calendar YearWeekNumber\", [Calendar YearWeekNumber],",
                "        \"Calendar Week Year\", [Calendar Week Year],",
                "        \"Calendar WeekYearOrder\", [Calendar WeekYearOrder],",
                "        \"Calendar RelativeWeekPos\", [Calendar RelativeWeekPos],",
                "        \"Calendar RelativeMonthPos\", [Calendar RelativeMonthPos],",
                "        \"Calendar RelativeQuarterPos\", [Calendar RelativeQuarterPos],",
                "        \"Calendar RelativeYearPos\", [Calendar RelativeYearPos],",
                "        \"Calendar StartOfMonth\", [Calendar StartOfMonth],",
                "        \"Calendar EndOfMonth\", [Calendar EndOfMonth],",
                "        \"Calendar StartOfQuarter\", [Calendar StartOfQuarter],",
                "        \"Calendar EndOfQuarter\", [Calendar EndOfQuarter],",
                "        \"Calendar StartOfYear\", [Calendar StartOfYear],",
                "        \"Calendar EndOfYear\", [Calendar EndOfYear],",
                "        \"Calendar MonthDays\", [Calendar MonthDays],",
                "        \"Calendar QuarterDays\", [Calendar QuarterDays],",
                "        \"Calendar YearDays\", [Calendar YearDays],",
                "        \"Calendar DayOfMonthNumber\", [Calendar DayOfMonthNumber],",
                "        \"Calendar DayOfQuarterNumber\", [Calendar DayOfQuarterNumber],",
                "        \"Calendar DayOfYearNumber\", [Calendar DayOfYearNumber],",
                "        \"Calendar DatePreviousWeek\", [Calendar DatePreviousWeek],",
                "        \"Calendar DatePreviousMonth\", [Calendar DatePreviousMonth],",
                "        \"Calendar DatePreviousQuarter\", [Calendar DatePreviousQuarter],",
                "        \"Calendar DatePreviousYear\", [Calendar DatePreviousYear],",
                "",
                "        -- Fiscal = Fiscal Monthly Calendar",
                "        \"Fiscal Year\", [Fiscal Year],",
                "        \"Fiscal YearNumber\", [Fiscal YearNumber],",
                "        \"Fiscal QuarterNumber\", [Fiscal QuarterNumber],",
                "        \"Fiscal Quarter\", [Fiscal Quarter],",
                "        \"Fiscal YearQuarterNumber\", [Fiscal YearQuarterNumber],",
                "        \"Fiscal Quarter Year\", [Fiscal Quarter Year],",
                "        \"Fiscal MonthNumber\", [Fiscal MonthNumber],",
                "        \"Fiscal Month\", [Fiscal Month],",
                "        \"Fiscal YearMonthNumber\", [Fiscal YearMonthNumber],",
                "        \"Fiscal Month Year\", [Fiscal Month Year],",
                "        \"Fiscal WeekNumber\", [Fiscal WeekNumber],",
                "        \"Fiscal Week\", [Fiscal Week],",
                "        \"Fiscal YearWeekNumber\", [Fiscal YearWeekNumber],",
                "        \"Fiscal Week Year\", [Fiscal Week Year],",
                "        \"Fiscal WeekYearOrder\", [Fiscal WeekYearOrder],",
                "        \"Fiscal RelativeWeekPos\", [Fiscal RelativeWeekPos],",
                "        \"Fiscal RelativeMonthPos\", [Fiscal RelativeMonthPos],",
                "        \"Fiscal RelativeQuarterPos\", [Fiscal RelativeQuarterPos],",
                "        \"Fiscal RelativeYearPos\", [Fiscal RelativeYearPos],",
                "        \"Fiscal StartOfMonth\", [Fiscal StartOfMonth],",
                "        \"Fiscal EndOfMonth\", [Fiscal EndOfMonth],",
                "        \"Fiscal StartOfQuarter\", [Fiscal StartOfQuarter],",
                "        \"Fiscal EndOfQuarter\", [Fiscal EndOfQuarter],",
                "        \"Fiscal StartOfYear\", [Fiscal StartOfYear],",
                "        \"Fiscal EndOfYear\", [Fiscal EndOfYear],",
                "        \"Fiscal MonthDays\", [Fiscal MonthDays],",
                "        \"Fiscal QuarterDays\", [Fiscal QuarterDays],",
                "        \"Fiscal YearDays\", [Fiscal YearDays],",
                "        \"Fiscal DayOfMonthNumber\", [Fiscal DayOfMonthNumber],",
                "        \"Fiscal DayOfQuarterNumber\", [Fiscal DayOfQuarterNumber],",
                "        \"Fiscal DayOfYearNumber\", [Fiscal DayOfYearNumber],",
                "        \"Fiscal DatePreviousWeek\", [Fiscal DatePreviousWeek],",
                "        \"Fiscal DatePreviousMonth\", [Fiscal DatePreviousMonth],",
                "        \"Fiscal DatePreviousQuarter\", [Fiscal DatePreviousQuarter],",
                "        \"Fiscal DatePreviousYear\", [Fiscal DatePreviousYear],",
                "",
                "        -- FW = Fiscal Weekly calendar",
                "        \"FW YearNumber\", [FW YearNumber],",
                "        \"FW Year\", [FW Year],",
                "        \"FW QuarterNumber\", [FW QuarterNumber],",
                "        \"FW Quarter\", [FW Quarter],",
                "        \"FW YearQuarterNumber\", [FW YearQuarterNumber],",
                "        \"FW Quarter Year\", [FW Quarter Year],",
                "        \"FW MonthNumber\", [FW MonthNumber],",
                "        \"FW Month\", [FW Month],",
                "        \"FW YearMonthNumber\", [FW YearMonthNumber],",
                "        \"FW Month Year\", [FW Month Year],",
                "        \"FW WeekNumber\", [FW WeekNumber],",
                "        \"FW Week\", [FW Week],",
                "        \"FW PeriodNumber\", [FW PeriodNumber],",
                "        \"FW Period\", [FW Period],",
                "        \"FW YearWeekNumber\", [FW YearWeekNumber],",
                "        \"FW Week Year\", [FW Week Year],",
                "        \"FW StartOfWeek\", [FW StartOfWeek],",
                "        \"FW EndOfWeek\", [FW EndOfWeek],",
                "        \"FW RelativeWeekPos\", [FW RelativeWeekPos],",
                "        \"FW RelativeMonthPos\", [FW RelativeMonthPos],",
                "        \"FW RelativeQuarterPos\", [FW RelativeQuarterPos],",
                "        \"FW RelativeYearPos\", [FW RelativeYearPos],",
                "        \"FW StartOfMonth\", [FW StartOfMonth],",
                "        \"FW EndOfMonth\", [FW EndOfMonth],",
                "        \"FW StartOfQuarter\", [FW StartOfQuarter],",
                "        \"FW EndOfQuarter\", [FW EndOfQuarter],",
                "        \"FW StartOfYear\", [FW StartOfYear],",
                "        \"FW EndOfYear\", [FW EndOfYear],",
                "        \"FW MonthDays\", [FW MonthDays],",
                "        \"FW QuarterDays\", [FW QuarterDays],",
                "        \"FW YearDays\", [FW YearDays],",
                "        \"FW DayOfMonthNumber\", [FW DayOfMonthNumber],",
                "        \"FW DayOfQuarterNumber\", [FW DayOfQuarterNumber],",
                "        \"FW DayOfYearNumber\", [FW DayOfYearNumber],",
                "        \"FW DatePreviousWeek\", [FW DatePreviousWeek],",
                "        \"FW DatePreviousMonth\", [FW DatePreviousMonth],",
                "        \"FW DatePreviousQuarter\", [FW DatePreviousQuarter],",
                "        \"FW DatePreviousYear\", [FW DatePreviousYear],",
                "",
                "        -- Holidays and working days",
                "        \"Holiday Name\", [Holiday Name],",
                "        \"IsWorkingDay\", [IsWorkingDay],",
                "        \"Day Type\", [Day Type]    ",
                "    )",
                "RETURN Result",
                ""
              ],
              "type": "calculated"
            }
          }
        ]
      },
      {
        "name": "Events",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Event ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "isKey": true,
            "lineageTag": "52328922-de5e-4a17-b344-7346989399f1",
            "sourceColumn": "Event ID",
            "summarizeBy": "none"
          },
          {
            "name": "Event Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a2208477-18dc-4372-a519-acf75bd001d9",
            "sourceColumn": "Event Name",
            "summarizeBy": "none"
          },
          {
            "name": "Event Date",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDateTimeCustom\":true}"
              }
            ],
            "dataType": "dateTime",
            "formatString": "m/d/yyyy",
            "lineageTag": "f3ca8cae-feb7-4255-8fd9-db5cd05c8c55",
            "sourceColumn": "Event Date",
            "summarizeBy": "none"
          },
          {
            "name": "Event Month",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "80ee5c75-dffa-4307-bc9c-2d293b9218d0",
            "sortByColumn": "SORT_MONTH",
            "sourceColumn": "Event Month",
            "summarizeBy": "none"
          },
          {
            "name": "Event FY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "27343a19-ad02-4ace-8b15-2adf9ad76a87",
            "sourceColumn": "Event FY",
            "summarizeBy": "none"
          },
          {
            "name": "Parent Event ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "682b3585-927c-4775-b362-2e35a16cfad7",
            "sourceColumn": "Parent Event ID",
            "summarizeBy": "count"
          },
          {
            "name": "Event Status",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "3859ec9e-ea53-4a0e-9c07-c1857ea00e63",
            "sourceColumn": "Event Status",
            "summarizeBy": "none"
          },
          {
            "name": "Event Type",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "618c4e73-1f61-4509-a497-b3ca83f0a8d0",
            "sourceColumn": "Event Type",
            "summarizeBy": "none"
          },
          {
            "name": "Event Venue",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "e79681d0-9fbc-495e-988d-083c5d80b740",
            "sourceColumn": "Event Venue",
            "summarizeBy": "none"
          },
          {
            "name": "Venue Desc",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ce327e5d-d0f7-47e3-b747-38f71d794988",
            "sourceColumn": "Venue Desc",
            "summarizeBy": "none"
          },
          {
            "name": "Event Content",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "4c9630ad-45c9-4e52-8d59-7f490659a138",
            "sourceColumn": "Event Content",
            "summarizeBy": "none"
          },
          {
            "name": "Event Purpose",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "875d167b-87e1-4cf1-a9b5-9cd67482acd5",
            "sourceColumn": "Event Purpose",
            "summarizeBy": "none"
          },
          {
            "name": "Workgroup",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "88002ddb-311a-48cd-8b7b-87d6d284fa39",
            "sourceColumn": "Workgroup",
            "summarizeBy": "none"
          },
          {
            "name": "Event Owner",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "894c125a-26a1-44ba-a5cc-27c4324c4e21",
            "sourceColumn": "Event Owner",
            "summarizeBy": "none"
          },
          {
            "name": "Invited",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "d6b442d8-1986-4f26-a910-b6cef161eef7",
            "sourceColumn": "Invited",
            "summarizeBy": "sum"
          },
          {
            "name": "Invite Cnt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "double",
            "formatString": "#,0",
            "lineageTag": "11b6c6a0-64cc-4232-92c5-c33b18d2b7a9",
            "sourceColumn": "Invite Cnt",
            "summarizeBy": "sum"
          },
          {
            "name": "Reg Status",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "652a3e46-b704-4a67-9c17-31f90c68c552",
            "sourceColumn": "Reg Status",
            "summarizeBy": "none"
          },
          {
            "name": "Reg Cnt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ee91d36d-2502-4baa-b5ef-2471b303002f",
            "sourceColumn": "Reg Cnt",
            "summarizeBy": "sum"
          },
          {
            "name": "Part Count",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "e49ce885-fc3a-480c-81cc-9c6e6ace04e7",
            "sourceColumn": "Part Count",
            "summarizeBy": "sum"
          },
          {
            "name": "NonPart Cnt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "4a5132f8-e5ba-41d5-94a4-f700e4f9ad90",
            "sourceColumn": "NonPart Cnt",
            "summarizeBy": "sum"
          },
          {
            "name": "Head Count",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "dataType": "double",
            "lineageTag": "ed3ae599-924f-47c2-ad2d-34fe8c385d8b",
            "sourceColumn": "Head Count",
            "summarizeBy": "sum"
          },
          {
            "name": "Attendance",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "double",
            "formatString": "#,0",
            "lineageTag": "831f0086-7a52-42ec-821f-4a778d831212",
            "sourceColumn": "Attendance",
            "summarizeBy": "sum"
          },
          {
            "name": "State",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7a075f91-6661-4d2a-8939-1cfc8fb52ae4",
            "sourceColumn": "State",
            "summarizeBy": "none"
          },
          {
            "name": "L_C_Threshold",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "b2a2bb30-6497-4576-aef0-c0e1ccc9045b",
            "sourceColumn": "L_C_Threshold",
            "summarizeBy": "none"
          },
          {
            "name": "SORT_MONTH",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a13279d4-8992-4fb1-afce-b726b440db4f",
            "sourceColumn": "SORT_MONTH",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "62a7674e-3095-4f64-aace-d6b494cd9022",
        "partitions": [
          {
            "name": "Events-b55e4dbe-a91d-4b08-b558-67a90a8d866c",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Oracle.Database(\"padv\", [HierarchicalNavigation=true, Query=\"-- Query created for Events ROI Report in Power BI; to be used in conjunction with \"\"Tasks_Query\"\" and \"\"Contact_Query\"\" smk 4/21/2021#(lf)-- Updated to remove a sub-query for registrations that was causing events with no registrations to be omitted; moved to a new query. smk 4/23/21#(lf)-- Updated to add a threshold date for linking contacts and leads  smk 4/23/21#(lf)select distinct e.event_id               \"\"Event ID\"\",#(lf)       e.event_name                      \"\"Event Name\"\",#(lf)       trunc(e.event_start_datetime)     \"\"Event Date\"\",#(lf)       trunc(e.event_start_datetime)+30  \"\"L_C_Threshold\"\",#(lf)       to_char(e.event_start_datetime,'Mon') \"\"Event Month\"\",#(lf)       to_char(ADD_MONTHS(e.event_start_datetime,6),'YYYY') \"\"Event FY\"\",#(lf)       e.master_event_id                 \"\"Parent Event ID\"\",#(lf)       es.short_desc                     \"\"Event Status\"\",#(lf)       et.short_desc                     \"\"Event Type\"\",#(lf)       ev.short_desc                     \"\"Event Venue\"\",#(lf)       e.venue                           \"\"Venue Desc\"\",#(lf)       ec.short_desc                     \"\"Event Content\"\",#(lf)       ep.short_desc                     \"\"Event Purpose\"\",#(lf)       o.pref_mail_name                  \"\"Workgroup\"\",#(lf)       s.pref_mail_name                  \"\"Event Owner\"\",#(lf)       e.invited_cnt                     \"\"Invited\"\",#(lf)       inv.trucnt                        \"\"Invite Cnt\"\",#(lf)       reg.regstat                       \"\"Reg Status\"\",#(lf)       reg.rcnt                          \"\"Reg Cnt\"\",#(lf)       prt_y.pcnt                        \"\"Part Count\"\",#(lf)       prt_n.pcnt                        \"\"NonPart Cnt\"\",#(lf)       to_number(hc.hcnt)                \"\"Head Count\"\",#(lf)       CASE WHEN to_number(hc.hcnt) > 0 THEN to_number(hc.hcnt)#(lf)          ELSE prt_y.pcnt END            \"\"Attendance\"\",#(lf)       e.venue_state                     \"\"State\"\",#(lf)       CASE WHEN to_char(e.event_start_datetime,'Mon') = 'Jul' THEN '01'#(lf)            WHEN to_char(e.event_start_datetime,'Mon') = 'Aug' THEN '02'#(lf)            WHEN to_char(e.event_start_datetime,'Mon') = 'Sep' THEN '03'#(lf)            WHEN to_char(e.event_start_datetime,'Mon') = 'Oct' THEN '04'#(lf)            WHEN to_char(e.event_start_datetime,'Mon') = 'Nov' THEN '05'#(lf)            WHEN to_char(e.event_start_datetime,'Mon') = 'Dec' THEN '06'#(lf)            WHEN to_char(e.event_start_datetime,'Mon') = 'Jan' THEN '07'#(lf)            WHEN to_char(e.event_start_datetime,'Mon') = 'Feb' THEN '08'#(lf)            WHEN to_char(e.event_start_datetime,'Mon') = 'Mar' THEN '09'#(lf)            WHEN to_char(e.event_start_datetime,'Mon') = 'Apr' THEN '10'#(lf)            WHEN to_char(e.event_start_datetime,'Mon') = 'May' THEN '11'#(lf)            WHEN to_char(e.event_start_datetime,'Mon') = 'Jun' THEN '12'#(lf)          ELSE '13' END                   Sort_Month#(lf)from advance.ep_event e#(lf)left join advance.tms_event_status es     ON e.event_status_code = es.event_status_code#(lf)left join advance.tms_event_type et       ON e.event_type = et.event_type#(lf)left join advance.tms_event_venue_code ev ON e.venue_code = ev.venue_code#(lf)left join advance.tms_event_content ec    ON e.content_code = ec.content_code#(lf)left join advance.tms_event_purpose ep    ON e.purpose_code = ep.purpose_code#(lf)left join advance.ep_event_organizer eo   ON e.event_id = eo.event_id#(lf)left join advance.entity o                ON eo.organization_id = o.id_number#(lf)left join advance.entity s                ON eo.id_number = s.id_number#(lf)left join (select distinct ei.event_id eid, count(distinct pi.id_number) trucnt#(lf)             from advance.ep_event_invitation ei, advance.ep_participant_invite pi#(lf)            where ei.invitation_id = pi.invitation_id#(lf)            group by ei.event_id#(lf)           )inv ON e.event_id = inv.eid#(lf)left join (select distinct r.event_id eid, rs.short_desc regstat, count(distinct r.registration_id) rcnt#(lf)             from advance.ep_registration r, advance.tms_event_registration_status rs#(lf)            where r.registration_status_code = rs.registration_status_code(+)#(lf)            and   r.registration_status_code = 'G'#(lf)            group by r.event_id, rs.short_desc#(lf)           )reg ON e.event_id = reg.eid#(lf)left join (select distinct p1.event_id eid, count(distinct p2.participation_id) pcnt#(lf)             from advance.ep_participant p1, advance.ep_participation p2, advance.tms_event_participant_status ps, advance.ep_event pe#(lf)            where p1.registration_id = p2.registration_id(+)#(lf)            and   p2.participation_status_code = ps.participant_status_code(+)#(lf)            and   p1.event_id = pe.event_id#(lf)            and   p2.participation_status_code IN ('P','W')#(lf)            group by p1.event_id#(lf)           )prt_y ON e.event_id = prt_y.eid#(lf)left join (select distinct p10.event_id eid, count(distinct p20.participation_id) pcnt#(lf)             from advance.ep_participant p10, advance.ep_participation p20, advance.tms_event_participant_status ps0, advance.ep_event pe0#(lf)            where p10.registration_id = p20.registration_id(+)#(lf)            and   p20.participation_status_code = ps0.participant_status_code(+)#(lf)            and   p10.event_id = pe0.event_id#(lf)            and   p20.participation_status_code NOT IN ('P','W')#(lf)            group by p10.event_id#(lf)            )prt_n ON e.event_id = prt_n.eid#(lf)left join (select distinct e15.event_id eid, ec15.note hcnt#(lf)             from advance.ep_event e15, advance.ep_event_codes ec15#(lf)            where e15.event_id = ec15.event_id#(lf)            and   ec15.event_code = 'HED'#(lf)            )hc ON e.event_id = hc.eid#(lf)where eo.organization_id = '0000248363'#(lf)and   to_char(ADD_MONTHS(trunc(e.event_start_datetime),6),'YYYY') >= '2020'#(lf)and   e.event_status_code NOT IN ('P','X','E','R','N','P')#(lf)#(lf)order by \"\"Event Date\"\" desc\"]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Event Date\", type date}, {\"L_C_Threshold\", type date}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Contacts",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Contact ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "#,0",
            "lineageTag": "5109078d-4e12-4a9d-8ee9-d11437246193",
            "sourceColumn": "Contact ID",
            "summarizeBy": "count"
          },
          {
            "name": "Event ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "3cf738c4-3248-43bb-ab27-fa2469756558",
            "sourceColumn": "Event ID",
            "summarizeBy": "none"
          },
          {
            "name": "Event Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "dcd9a689-68ee-4fae-9986-42782f8723a5",
            "sourceColumn": "Event Name",
            "summarizeBy": "none"
          },
          {
            "name": "Event Dt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDateTimeCustom\":true}"
              }
            ],
            "dataType": "dateTime",
            "formatString": "m/d/yyyy",
            "lineageTag": "6f2055b6-8310-4c71-9015-dad4d1e2edd7",
            "sourceColumn": "Event Dt",
            "summarizeBy": "none"
          },
          {
            "name": "Entity ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "cfc3191b-6b90-4580-8711-31ecb5e062c8",
            "sourceColumn": "Entity ID",
            "summarizeBy": "none"
          },
          {
            "name": "Contact Dt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDateTimeCustom\":true}"
              }
            ],
            "dataType": "dateTime",
            "formatString": "m/d/yyyy",
            "lineageTag": "13db8a3f-b4f5-40a4-96b8-baf436c43686",
            "sourceColumn": "Contact Dt",
            "summarizeBy": "none"
          },
          {
            "name": "Contact FY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "017e09e7-db88-4fa2-a809-db579b945b4e",
            "sourceColumn": "Contact FY",
            "summarizeBy": "none"
          },
          {
            "name": "Contact Purpose",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "808d80d1-fa0a-4e74-a7c2-150763c623e8",
            "sourceColumn": "Contact Purpose",
            "summarizeBy": "none"
          },
          {
            "name": "Contact Type",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "33d1046e-d064-4521-9fb4-b8b9a3fa790f",
            "sourceColumn": "Contact Type",
            "summarizeBy": "none"
          },
          {
            "name": "Contact Description",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ec496eff-e3f4-48c8-b3bf-3d9d98c4b371",
            "sourceColumn": "Contact Description",
            "summarizeBy": "none"
          },
          {
            "name": "Contacted Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "25df1811-4364-40c4-befa-a1dd6addba18",
            "sourceColumn": "Contacted Name",
            "summarizeBy": "none"
          },
          {
            "name": "Author",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7659bb4a-e2d8-4f76-ac8c-41817ec1d62d",
            "sourceColumn": "Author",
            "summarizeBy": "none"
          },
          {
            "name": "Author Unit",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "81e477a8-ee03-4189-bc9d-b7f8e74170ee",
            "sourceColumn": "Author Unit",
            "summarizeBy": "none"
          },
          {
            "name": "Entity Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "213910d8-d2dc-4242-97ce-8708d59eccf5",
            "sourceColumn": "Entity Name",
            "summarizeBy": "none"
          },
          {
            "name": "Entity Rec Types",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "648cc5f5-e6cc-45cb-83fc-a81e1b952d5e",
            "sourceColumn": "Entity Rec Types",
            "summarizeBy": "none"
          },
          {
            "name": "Entity Status",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f10e27b2-bd4f-4d81-b058-bcf942627489",
            "sourceColumn": "Entity Status",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "098d2f84-01d4-48f3-bb79-0b1a37ef3097",
        "partitions": [
          {
            "name": "Contacts-f6daa508-e545-4401-a5ce-3be6fbc730f2",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Oracle.Database(\"padv\", [HierarchicalNavigation=true, Query=\"-- Query created for Events ROI Report in Power BI; to be used in conjunction with \"\"Tasks_Query\"\" and \"\"Events_w-contacts n tasks\"\" smk 4/21/2021#(lf)-- Re-wrote the \"\"Registrant\"\" sub-query to connect the tasks to the participants rather than the registrants. smk 4/23/21#(lf)select distinct cr1.report_id                                \"\"Contact ID\"\", #(lf)       rg.eid                                                \"\"Event ID\"\",#(lf)       rg.enme                                               \"\"Event Name\"\",#(lf)       rg.edt1                                               \"\"Event Dt\"\",#(lf)       cr1.id_number                                         \"\"Entity ID\"\",#(lf)       rg.prtnme                                             \"\"Entity Name\"\",#(lf)       rg.prttyp                                             \"\"Entity Rec Types\"\",#(lf)       rg.regstat                                            \"\"Entity Status\"\",#(lf)       trunc(cr1.contact_date)                               \"\"Contact Dt\"\", #(lf)       to_char(ADD_MONTHS(trunc(cr1.contact_date),6),'YYYY') \"\"Contact FY\"\",#(lf)       purp1.short_desc                                      \"\"Contact Purpose\"\", #(lf)       t1.short_desc                                         \"\"Contact Type\"\",#(lf)       cr1.description                                       \"\"Contact Description\"\", #(lf)       e1.pref_mail_name                                     \"\"Contacted Name\"\", #(lf)       a1.pref_mail_name                                     \"\"Author\"\", #(lf)       uc1.short_desc                                        \"\"Author Unit\"\"#(lf)from advance.contact_report cr1#(lf)join advance.tms_contact_rpt_purpose purp1 ON cr1.contact_purpose_code = purp1.contact_purpose_code#(lf)join advance.tms_contact_rpt_type t1       ON cr1.contact_type = t1.contact_type#(lf)join advance.entity e1                     ON cr1.id_number = e1.id_number#(lf)join advance.entity a1                     ON cr1.author_id_number = a1.id_number#(lf)join advance.staff s1                      ON a1.id_number = s1.id_number#(lf)join advance.tms_unit_code uc1             ON s1.unit_code = uc1.unit_code#(lf)left join (select xpe1.id_number pid#(lf)             from advance.prospect_entity xpe1#(lf)           ) pros ON cr1.prospect_id = pros.pid#(lf)join (select r2.event_id eid, trunc(ev2.event_stop_datetime) edt1, trunc(ev2.event_stop_datetime)+30 edt2, ev2.event_name enme, r2.contact_id_number rid,#(lf)             rs2.short_desc rst, trunc(r2.response_date) regdt,#(lf)             CASE WHEN r2.contact_id_number = ' ' THEN p10.pref_mail_name#(lf)                  WHEN r2.contact_id_number IS NULL THEN p10.pref_mail_name#(lf)                ELSE e10.pref_mail_name END regnme, advdeploy.fn_get_record_type(e10.id_number) regtyp, p10.id_number prtid,#(lf)             CASE WHEN p10.id_number = ' ' THEN p10.pref_mail_name#(lf)                  WHEN p10.id_number IS NULL THEN p10.pref_mail_name#(lf)                ELSE e10p.pref_mail_name END prtnme, advdeploy.fn_get_record_type(e10p.id_number) prttyp, ps10.short_desc regstat, e10.pref_name_sort regsrt#(lf)        from advance.ep_registration r2#(lf)        join advance.tms_event_registration_status rs2 ON r2.registration_status_code = rs2.registration_status_code#(lf)        join advance.ep_event ev2                      ON r2.event_id = ev2.event_id#(lf)        join advance.ep_participant p10                ON r2.registration_id = p10.registration_id#(lf)        left join advance.entity e10p                  ON p10.id_number = e10p.id_number#(lf)        left join advance.entity e10                   ON r2.contact_id_number = e10.id_number#(lf)        left join advance.tms_record_status ps10       ON e10p.record_status_code = ps10.record_status_code#(lf)       where r2.registration_status_code = 'G'#(lf)       and   trunc(ev2.event_stop_datetime) >= '01-JAN-2019'#(lf)      ) rg ON cr1.id_number = rg.prtid#(lf)where cr1.contact_type <> 'DR'#(lf)and   cr1.contact_purpose_code <> 'I'#(lf)and   to_char(ADD_MONTHS(trunc(cr1.contact_date),6),'YYYY') >= '2020'#(lf)and   trunc(cr1.contact_date) BETWEEN rg.edt1 AND rg.edt2\"]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Event Dt\", type date}, {\"Contact Dt\", type date}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Lead Tasks",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Task ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "c0a44a01-ae51-43f6-8397-81ed683fdb26",
            "sourceColumn": "Task ID",
            "summarizeBy": "count"
          },
          {
            "name": "Event ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "9ad9dee8-e749-4094-b65b-475bc01a436a",
            "sourceColumn": "Event ID",
            "summarizeBy": "none"
          },
          {
            "name": "Event Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f2614c54-4338-4fd7-b1ae-eeceaea9bb7f",
            "sourceColumn": "Event Name",
            "summarizeBy": "none"
          },
          {
            "name": "Event Dt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDateTimeCustom\":true}"
              }
            ],
            "dataType": "dateTime",
            "formatString": "m/d/yyyy",
            "lineageTag": "9bd9e93e-57d1-46ed-978d-1330ec7ea935",
            "sourceColumn": "Event Dt",
            "summarizeBy": "none"
          },
          {
            "name": "Target ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7fc8f58b-47b8-4ac3-a421-1bd1b8d4b0fa",
            "sourceColumn": "Target ID",
            "summarizeBy": "none"
          },
          {
            "name": "Target Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "450054f4-065b-40dd-bfd0-05c81496f592",
            "sourceColumn": "Target Name",
            "summarizeBy": "none"
          },
          {
            "name": "Task Cd",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "fe4b893a-4c81-4126-8e02-be178dbe0978",
            "sourceColumn": "Task Cd",
            "summarizeBy": "none"
          },
          {
            "name": "Task Description",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "28b3ae2b-8831-482d-befc-fd1f0c5dadad",
            "sourceColumn": "Task Description",
            "summarizeBy": "none"
          },
          {
            "name": "Task Status",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "3bca0d34-b719-4068-ab55-6dbb373e2dab",
            "sourceColumn": "Task Status",
            "summarizeBy": "none"
          },
          {
            "name": "Task Priority",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d6e9e2ff-30ec-405e-8f21-e25437c82a3b",
            "sourceColumn": "Task Priority",
            "summarizeBy": "none"
          },
          {
            "name": "Sched Dt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDateTimeCustom\":true}"
              }
            ],
            "dataType": "dateTime",
            "formatString": "m/d/yyyy",
            "lineageTag": "9a95c376-4d3e-498e-9fb6-2ea4e01bb606",
            "sourceColumn": "Sched Dt",
            "summarizeBy": "none"
          },
          {
            "name": "Task FY",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a74ddd98-6cb1-438e-938f-a5099119a7a3",
            "sourceColumn": "Task FY",
            "summarizeBy": "none"
          },
          {
            "name": "Compl Dt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "fb3972ef-a135-4709-b599-9d0506bd3e26",
            "sourceColumn": "Compl Dt",
            "summarizeBy": "none"
          },
          {
            "name": "Task Purp",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6f1a341d-f4d4-44de-8f0a-5689a4ac091d",
            "sourceColumn": "Task Purp",
            "summarizeBy": "none"
          },
          {
            "name": "Task Description2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "3aa6903b-4cac-4984-864a-0644f6dbfa77",
            "sourceColumn": "Task Description2",
            "summarizeBy": "none"
          },
          {
            "name": "Source ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d080d59f-8664-4c8c-b4b1-d0ef9adc341c",
            "sourceColumn": "Source ID",
            "summarizeBy": "none"
          },
          {
            "name": "Source Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ac44dd77-1460-4ee0-bcd5-53858ce61668",
            "sourceColumn": "Source Name",
            "summarizeBy": "none"
          },
          {
            "name": "Task Event ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "9826de6c-9649-4726-8b96-81ccf72840ac",
            "sourceColumn": "Task Event ID",
            "summarizeBy": "count"
          },
          {
            "name": "Unit",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a44e0891-885b-4ca2-8aba-e1e82bfd822c",
            "sourceColumn": "Unit",
            "summarizeBy": "none"
          },
          {
            "name": "Owner ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a2fda2c3-5daa-4872-86a1-3a386ea13afd",
            "sourceColumn": "Owner ID",
            "summarizeBy": "none"
          },
          {
            "name": "Owner Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "1a2c0f76-00ce-4ab4-be3e-fef25789f7b8",
            "sourceColumn": "Owner Name",
            "summarizeBy": "none"
          },
          {
            "name": "Resp ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a4bd3f1b-f374-4e5e-ba7b-fa6d1b330b33",
            "sourceColumn": "Resp ID",
            "summarizeBy": "none"
          },
          {
            "name": "Responsible Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a56f59ee-f41c-4fbe-b25c-2b9f0612d9f3",
            "sourceColumn": "Responsible Name",
            "summarizeBy": "none"
          },
          {
            "name": "Assgn Type",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "56899795-3810-4f4d-9bd2-f3cc7f5cd458",
            "sourceColumn": "Assgn Type",
            "summarizeBy": "none"
          },
          {
            "name": "Resp Unit",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "a2571882-9d80-431a-9a9d-85522138ff12",
            "sourceColumn": "Resp Unit",
            "summarizeBy": "none"
          },
          {
            "name": "Resp Office",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "7bc37813-b93b-4299-b3bc-09f8a1c8c2d6",
            "sourceColumn": "Resp Office",
            "summarizeBy": "none"
          },
          {
            "name": "Target Rec Types",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "52eb1787-550f-4416-8621-ca26de901eb7",
            "sourceColumn": "Target Rec Types",
            "summarizeBy": "none"
          },
          {
            "name": "Target Status",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "af96f178-0c5c-41d5-bad6-62d2aa0bf18e",
            "sourceColumn": "Target Status",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "1bbaf3fb-f4ef-43c9-a8e1-d0d9b1379e6b",
        "partitions": [
          {
            "name": "Lead Tasks-eeb0ba74-9cd9-4ee8-81e0-c2e67ff1b2ea",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Oracle.Database(\"padv\", [HierarchicalNavigation=true, Query=\"-- Query created for Events ROI Report in Power BI; to be used in conjunction with \"\"Events_w-contacts n tasks\"\" and \"\"Contact_Query\"\" smk 4/21/2021#(lf)-- Re-wrote the \"\"Registrant\"\" sub-query to connect the tasks to the participants rather than the registrants. smk 4/23/21#(lf)select distinct t.task_id                                \"\"Task ID\"\",#(lf)       rg2.eid                                           \"\"Event ID\"\",#(lf)       rg2.enme                                          \"\"Event Name\"\",#(lf)       rg2.edt1                                          \"\"Event Dt\"\",#(lf)       t.id_number                                       \"\"Target ID\"\",#(lf)       e1.pref_mail_name                                 \"\"Target Name\"\",#(lf)       rg2.prttyp                                        \"\"Target Rec Types\"\",#(lf)       rg2.regstat                                       \"\"Target Status\"\",#(lf)       t.task_code                                       \"\"Task Cd\"\",#(lf)       tt.short_desc                                     \"\"Task Description\"\",#(lf)       ts.short_desc                                     \"\"Task Status\"\",#(lf)       t.task_priority_code                              \"\"Task Priority\"\",#(lf)       trunc(t.sched_date)                               \"\"Sched Dt\"\",#(lf)       to_char(ADD_MONTHS(trunc(t.sched_date),6),'YYYY') \"\"Task FY\"\",#(lf)       trunc(t.completed_date)                           \"\"Compl Dt\"\",#(lf)       t.task_purpose_code                               \"\"Task Purp\"\",#(lf)       t.task_description                                \"\"Task Description\"\",#(lf)       t.source_id_number                                \"\"Source ID\"\",#(lf)       e2.pref_mail_name                                 \"\"Source Name\"\",#(lf)       t.event_id                                        \"\"Task Event ID\"\",#(lf)       t.unit_code                                       \"\"Unit\"\",#(lf)       t.owner_id_number                                 \"\"Owner ID\"\",#(lf)       e3.pref_mail_name                                 \"\"Owner Name\"\",#(lf)       tr.id_number                                      \"\"Resp ID\"\",#(lf)       e4.pref_mail_name                                 \"\"Responsible Name\"\",#(lf)       tr.assign_type                                    \"\"Assgn Type\"\",#(lf)       tr.unit_code                                      \"\"Resp Unit\"\",#(lf)       tr.office_code                                    \"\"Resp Office\"\"#(lf)from advance.task t#(lf)left join advance.task_responsible tr ON t.task_id = tr.task_id#(lf)join advance.tms_task tt              ON t.task_code = tt.task_code#(lf)join advance.tms_task_status ts       ON t.task_status_code = ts.task_status_code#(lf)left join advance.entity e1           ON t.id_number = e1.id_number#(lf)left join advance.entity e2           ON t.source_id_number = e2.id_number#(lf)left join advance.entity e3           ON t.owner_id_number = e3.id_number#(lf)left join advance.entity e4           ON tr.id_number = e4.id_number#(lf)join (select r2.event_id eid, trunc(ev2.event_stop_datetime) edt1, trunc(ev2.event_stop_datetime)+30 edt2, ev2.event_name enme, r2.contact_id_number rid,#(lf)             rs2.short_desc rst, trunc(r2.response_date) regdt,#(lf)             CASE WHEN r2.contact_id_number = ' ' THEN p10.pref_mail_name#(lf)                  WHEN r2.contact_id_number IS NULL THEN p10.pref_mail_name#(lf)                ELSE e10.pref_mail_name END regnme, advdeploy.fn_get_record_type(e10.id_number) regtyp, p10.id_number prtid,#(lf)             CASE WHEN p10.id_number = ' ' THEN p10.pref_mail_name#(lf)                  WHEN p10.id_number IS NULL THEN p10.pref_mail_name#(lf)                ELSE e10p.pref_mail_name END prtnme, advdeploy.fn_get_record_type(e10p.id_number) prttyp, ps10.short_desc regstat, e10.pref_name_sort regsrt#(lf)        from advance.ep_registration r2#(lf)        join advance.tms_event_registration_status rs2 ON r2.registration_status_code = rs2.registration_status_code#(lf)        join advance.ep_event ev2                      ON r2.event_id = ev2.event_id#(lf)        join advance.ep_participant p10                ON r2.registration_id = p10.registration_id#(lf)        left join advance.entity e10p                  ON p10.id_number = e10p.id_number#(lf)        left join advance.entity e10                   ON r2.contact_id_number = e10.id_number#(lf)        left join advance.tms_record_status ps10       ON e10p.record_status_code = ps10.record_status_code#(lf)       where r2.registration_status_code = 'G'#(lf)       and   trunc(ev2.event_stop_datetime) >= '01-JAN-2019'#(lf)      ) rg2 ON t.id_number = rg2.prtid AND t.id_number <> ' '#(lf)#(lf)where t.task_description LIKE '%LEAD%'#(lf)and   trunc(t.sched_date) >= '01-JUL-2019'#(lf)and   trunc(t.sched_date) BETWEEN rg2.edt1 AND rg2.edt2#(lf)#(lf)order by trunc(t.sched_date) desc\"]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Event Dt\", type date}, {\"Sched Dt\", type date}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Key Measures",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "lineageTag": "4e562e36-6daa-46c5-8fb1-3b195b637b5d",
        "measures": [
          {
            "name": "Last Refreshed",
            "expression": "FORMAT(LASTDATE('Last Refresh'[LastRefresh]),\"mmm dd, yyyy hh:mm:ss AM/PM\")",
            "lineageTag": "79aaff02-77b8-46f6-9f2d-66fc0d040d61"
          },
          {
            "name": "Total Events",
            "expression": [
              "",
              "CALCULATE( ",
              "    DISTINCTCOUNT(Events[Event ID]),",
              "        USERELATIONSHIP( 'Date'[Date], Events[Event Date] ) )"
            ],
            "formatString": "0",
            "lineageTag": "b1655196-9668-4314-b1c4-5d6bdf800737"
          },
          {
            "name": "Total Attendance",
            "expression": [
              "",
              "CALCULATE( ",
              "    SUMX(Events, Events[Attendance]),",
              "        USERELATIONSHIP( 'Date'[Date], Events[Event Date] ) )"
            ],
            "formatString": "#,0",
            "lineageTag": "c80b9492-403d-4875-8543-caba2f5fdf33"
          },
          {
            "name": "Total Leads",
            "expression": [
              "",
              "CALCULATE( ",
              "    DISTINCTCOUNT('Lead Tasks'[Task ID]),",
              "        USERELATIONSHIP( 'Date'[Date], 'Lead Tasks'[Sched Dt] ) )"
            ],
            "formatString": "#,0",
            "lineageTag": "9f5cd6cf-4810-46e8-a184-8a4522ced697"
          },
          {
            "name": "Total Contacts",
            "expression": [
              "",
              "CALCULATE( ",
              "    DISTINCTCOUNT(Contacts[Contact ID]),",
              "        USERELATIONSHIP( 'Date'[Date], Contacts[Contact Dt] ",
              "        ) ",
              ")"
            ],
            "formatString": "#,0",
            "lineageTag": "cca082b1-d45b-4336-b45a-ccafb5e3b21f"
          },
          {
            "name": "Count of Leads",
            "expression": [
              "",
              "    COUNTROWS(",
              "        GENERATE(",
              "            'Lead Tasks',",
              "            FILTER(Participants,",
              "                    'Lead Tasks'[Target ID] = Participants[Part ID] &&",
              "                    'Lead Tasks'[Sched Dt] >= Participants[Event Dt 1] &&",
              "                    'Lead Tasks'[Sched Dt] <= Participants[Event Dt 2]",
              "            )",
              "        )",
              "    )",
              "                    "
            ],
            "formatString": "#,0",
            "lineageTag": "a6ba224a-4004-4466-a45a-321069cce010"
          },
          {
            "name": "Contacts per Event",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "    CALCULATE(",
              "        DISTINCTCOUNT(Contacts[Contact ID])/DISTINCTCOUNT(Events[Event ID])",
              "    )"
            ],
            "lineageTag": "05f04787-070e-43d0-8d21-8f45eb2ec2b6"
          },
          {
            "name": "Leads per Event",
            "annotations": [
              {
                "name": "PBI_FormatHint",
                "value": "{\"isGeneralNumber\":true}"
              }
            ],
            "expression": [
              "",
              "    CALCULATE(",
              "        DISTINCTCOUNT('Lead Tasks'[Task ID])/DISTINCTCOUNT(Events[Event ID])",
              "    )"
            ],
            "lineageTag": "dae17de7-673b-4ab7-b0ba-595fbc36e5e2"
          }
        ],
        "partitions": [
          {
            "name": "Key Measures-dfc28576-64d7-4646-a135-f779bad5b224",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i44FAA==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [Column1 = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Column1\", type text}}),",
                "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type\",{\"Column1\"})",
                "in",
                "    #\"Removed Columns\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Last Refresh",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "LastRefresh",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "dateTime",
            "formatString": "General Date",
            "lineageTag": "4f3ff623-747f-498c-b282-c5dcb0b8b87d",
            "sourceColumn": "LastRefresh",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "dd609e26-b909-47c9-8399-f6fdb48e88c0",
        "partitions": [
          {
            "name": "Last Refresh-83b75757-7859-4e49-8982-64a363c13dea",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "Source = #table(type table[LastRefresh=datetime], {{DateTime.LocalNow()}})",
                "in",
                "Source"
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "Participants",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Event ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "int64",
            "formatString": "0",
            "lineageTag": "8a348d11-8aef-41b9-ad77-37b40c587ccf",
            "sourceColumn": "Event ID",
            "summarizeBy": "none"
          },
          {
            "name": "Registrant ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "c98a829c-af0a-4ad3-b95d-4b299b9007a0",
            "sourceColumn": "Registrant ID",
            "summarizeBy": "none"
          },
          {
            "name": "Reg Status",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "01f50dba-f974-4d3d-81bc-cbf8b9e5c23c",
            "sourceColumn": "Reg Status",
            "summarizeBy": "none"
          },
          {
            "name": "Reg Dt",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "b6ac4baf-9396-4551-a1c9-21e40fb1dda0",
            "sourceColumn": "Reg Dt",
            "summarizeBy": "none"
          },
          {
            "name": "Registrant Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "f9069205-1a0d-4882-bf79-9f7b6c36331e",
            "sortByColumn": "Registrant Sort",
            "sourceColumn": "Registrant Name",
            "summarizeBy": "none"
          },
          {
            "name": "Reg Rec Types",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "42b0d0e3-319b-49f0-ab9a-8a0d72dd9e2a",
            "sourceColumn": "Reg Rec Types",
            "summarizeBy": "none"
          },
          {
            "name": "Part ID",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "bdde4339-a8cd-43af-97c7-943479de5d76",
            "sourceColumn": "Part ID",
            "summarizeBy": "none"
          },
          {
            "name": "Participant Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d2db8967-4c57-4dac-ac6c-feba1f20880f",
            "sourceColumn": "Participant Name",
            "summarizeBy": "none"
          },
          {
            "name": "Part Rec Types",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "41ffb748-1e41-4dff-8d3f-b7a1401dc6c9",
            "sourceColumn": "Part Rec Types",
            "summarizeBy": "none"
          },
          {
            "name": "Part Rel Cd",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "043ba84a-c669-4728-bbd6-59485be888d6",
            "sourceColumn": "Part Rel Cd",
            "summarizeBy": "none"
          },
          {
            "name": "Record Status",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "ae7ed6d5-0b84-44b0-b6c1-043f80412ea8",
            "sourceColumn": "Record Status",
            "summarizeBy": "none"
          },
          {
            "name": "Registrant Sort",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "6bfc92e9-a873-471c-b83e-4501b3c61c00",
            "sourceColumn": "Registrant Sort",
            "summarizeBy": "none"
          },
          {
            "name": "Event Dt 1",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              },
              {
                "name": "PBI_FormatHint",
                "value": "{\"isDateTimeCustom\":true}"
              }
            ],
            "dataType": "dateTime",
            "formatString": "m/d/yyyy",
            "lineageTag": "11fb52b4-7c2d-4395-a2ee-f9bfaadfab25",
            "sourceColumn": "Event Dt 1",
            "summarizeBy": "none"
          },
          {
            "name": "Event Dt 2",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              },
              {
                "name": "UnderlyingDateTimeDataType",
                "value": "Date"
              }
            ],
            "dataType": "dateTime",
            "formatString": "Long Date",
            "lineageTag": "b37a278e-1638-4979-bed7-c1d392b316b4",
            "sourceColumn": "Event Dt 2",
            "summarizeBy": "none"
          },
          {
            "name": "Event Name",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "lineageTag": "d6cdcc2a-79bd-453d-ba42-6dbda56d3826",
            "sourceColumn": "Event Name",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "b0ce57c5-98db-4b83-962b-77caed1b9f66",
        "partitions": [
          {
            "name": "Participants-b59e91c1-30e9-46d5-a899-b7c916161391",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Oracle.Database(\"padv\", [HierarchicalNavigation=true, Query=\"-- This query was written in support of the ARO Events ROI Power BI Report.  smk 4/26/21#(lf)select distinct r10.event_id              \"\"Event ID\"\",#(lf)       ev10.event_name                    \"\"Event Name\"\",#(lf)       trunc(ev10.event_stop_datetime)    \"\"Event Dt 1\"\",#(lf)       trunc(ev10.event_stop_datetime)+30 \"\"Event Dt 2\"\",#(lf)       r10.contact_id_number              \"\"Registrant ID\"\",#(lf)       rs.short_desc                      \"\"Reg Status\"\",#(lf)       trunc(r10.response_date)           \"\"Reg Dt\"\",#(lf)       CASE WHEN r10.contact_id_number = ' ' THEN p10.pref_mail_name#(lf)            WHEN r10.contact_id_number IS NULL THEN p10.pref_mail_name#(lf)          ELSE e10.pref_mail_name END     \"\"Registrant Name\"\",#(lf)       advdeploy.fn_get_record_type(e10.id_number) \"\"Reg Rec Types\"\",#(lf)       p10.id_number                      \"\"Part ID\"\",#(lf)       CASE WHEN p10.id_number = ' ' THEN p10.pref_mail_name#(lf)            WHEN p10.id_number IS NULL THEN p10.pref_mail_name#(lf)          ELSE e10p.pref_mail_name END    \"\"Participant Name\"\",#(lf)       advdeploy.fn_get_record_type(e10p.id_number) \"\"Part Rec Types\"\",#(lf)       p10.guest_relationship_code        \"\"Part Rel Cd\"\",#(lf)       rs10.short_desc                    \"\"Record Status\"\",#(lf)       CASE WHEN r10.contact_id_number = ' ' THEN p10.last_name||', '||p10.first_name#(lf)            WHEN r10.contact_id_number IS NULL THEN p10.last_name||', '||p10.first_name#(lf)          ELSE e10.pref_name_sort END     \"\"Registrant Sort\"\"#(lf)from advance.ep_registration r10#(lf)join advance.tms_event_registration_status rs ON r10.registration_status_code = rs.registration_status_code#(lf)join advance.ep_event ev10                    ON r10.event_id = ev10.event_id#(lf)join advance.ep_participant p10               ON r10.registration_id = p10.registration_id#(lf)left join advance.entity e10p                 ON p10.id_number = e10p.id_number#(lf)left join advance.entity e10                  ON r10.contact_id_number = e10.id_number#(lf)left join advance.tms_record_status rs10      ON e10.record_status_code = rs10.record_status_code#(lf)where r10.registration_status_code = 'G'#(lf)and   trunc(ev10.event_stop_datetime) >= '01-JUL-2019'#(lf)#(lf)order by \"\"Event ID\"\", \"\"Registrant Sort\"\"\"]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Reg Dt\", type date}, {\"Event Dt 1\", type date}, {\"Event Dt 2\", type date}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "FY Contacts",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Fiscal Yr",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isKey": true,
            "lineageTag": "f7185977-6c27-4553-814f-2b155c899c03",
            "sourceColumn": "Fiscal Yr",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "ff65f448-821f-45c7-9091-b87f3bc26322",
        "partitions": [
          {
            "name": "FY Contacts-c3ad86f8-b6ed-4e67-889c-41178436659f",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45WMjIwMlCK1QEzDGEMIxjDGMYwgTFMlWJjAQ==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [#\"Fiscal Yr\" = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Fiscal Yr\", type text}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "FY Events",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Fiscal Yr",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isKey": true,
            "lineageTag": "1a2d7e7a-2049-4478-a907-d81b09d68873",
            "sourceColumn": "Fiscal Yr",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "4cbe074d-b239-4590-a562-280f13f3e907",
        "partitions": [
          {
            "name": "FY Events-6146435e-3a70-43e8-9223-84c9b140d04f",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45WMjIwMlCK1QEzDGEMIxjDGMYwgTFMlWJjAQ==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [#\"Fiscal Yr\" = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Fiscal Yr\", type text}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      },
      {
        "name": "FY Leads",
        "annotations": [
          {
            "name": "PBI_ResultType",
            "value": "Table"
          }
        ],
        "columns": [
          {
            "name": "Fiscal Yr",
            "annotations": [
              {
                "name": "SummarizationSetBy",
                "value": "Automatic"
              }
            ],
            "dataType": "string",
            "isKey": true,
            "lineageTag": "3abfe922-38d9-4f4e-b31a-36a4b4b61d7d",
            "sourceColumn": "Fiscal Yr",
            "summarizeBy": "none"
          }
        ],
        "lineageTag": "7c165f44-afe6-41bb-9013-38da04deea1e",
        "partitions": [
          {
            "name": "FY Leads-54bcfa3c-ea18-4c28-b5cb-fcc2fbecbe1b",
            "mode": "import",
            "source": {
              "expression": [
                "let",
                "    Source = Table.FromRows(Json.Document(Binary.Decompress(Binary.FromText(\"i45WMjIwMlCK1QEzDGEMIxjDGMYwgTFMlWJjAQ==\", BinaryEncoding.Base64), Compression.Deflate)), let _t = ((type nullable text) meta [Serialized.Text = true]) in type table [#\"Fiscal Yr\" = _t]),",
                "    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"Fiscal Yr\", type text}})",
                "in",
                "    #\"Changed Type\""
              ],
              "type": "m"
            }
          }
        ]
      }
    ]
  }
}